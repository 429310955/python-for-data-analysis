```python
import pandas as pd
import numpy as np
%matplotlib inline
import matplotlib.pyplot as plt
import seaborn as sns
from pyecharts.charts import *
from pyecharts.components import Table
from pyecharts import options as opts
```

# 导入并查看数据


```python
data_user = pd.read_csv('C:/Users/luoyiming/Downloads/tianchi_mobile_recommend_train_user.csv')
data_user.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>item_id</th>
      <th>behavior_type</th>
      <th>user_geohash</th>
      <th>item_category</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>98047837</td>
      <td>232431562</td>
      <td>1</td>
      <td>NaN</td>
      <td>4245</td>
      <td>2014-12-06 02</td>
    </tr>
    <tr>
      <th>1</th>
      <td>97726136</td>
      <td>383583590</td>
      <td>1</td>
      <td>NaN</td>
      <td>5894</td>
      <td>2014-12-09 20</td>
    </tr>
    <tr>
      <th>2</th>
      <td>98607707</td>
      <td>64749712</td>
      <td>1</td>
      <td>NaN</td>
      <td>2883</td>
      <td>2014-12-18 11</td>
    </tr>
    <tr>
      <th>3</th>
      <td>98662432</td>
      <td>320593836</td>
      <td>1</td>
      <td>96nn52n</td>
      <td>6562</td>
      <td>2014-12-06 10</td>
    </tr>
    <tr>
      <th>4</th>
      <td>98145908</td>
      <td>290208520</td>
      <td>1</td>
      <td>NaN</td>
      <td>13926</td>
      <td>2014-12-16 21</td>
    </tr>
  </tbody>
</table>
</div>




```python
data_user.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 12256906 entries, 0 to 12256905
    Data columns (total 6 columns):
     #   Column         Dtype 
    ---  ------         ----- 
     0   user_id        int64 
     1   item_id        int64 
     2   behavior_type  int64 
     3   user_geohash   object
     4   item_category  int64 
     5   time           object
    dtypes: int64(4), object(2)
    memory usage: 561.1+ MB
    

各字段含义：

user_id	用户标识

item_id	商品标识

behavior_type	用户对商品的行为类型,包括浏览、收藏、加购物车、购买，对应取值分别是1、2、3、4

user_geohash	用户位置的空间标识，可以为空	

item_category	商品分类标识	

time	行为时间,精确到小时


```python
data_user.isnull().sum()
```




    user_id                0
    item_id                0
    behavior_type          0
    user_geohash     8334824
    item_category          0
    time                   0
    dtype: int64



观察到用户位置这一列存在大量的缺失值，故在后续数据处理中删除该列。

# 数据处理


```python
del data_user['user_geohash']
data_user.reset_index(drop=True,inplace=True)
data_user['date'] = data_user['time'].apply(lambda x:x.split(' ')[0])
data_user['hour'] = data_user['time'].apply(lambda x:x.split(' ')[1])
data_user['time'] = pd.to_datetime(data_user['time'])
data_user['date'] = pd.to_datetime(data_user['date'])
data_user['hour'] = data_user['hour'].astype('int64')
data_user.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 12256906 entries, 0 to 12256905
    Data columns (total 7 columns):
     #   Column         Dtype         
    ---  ------         -----         
     0   user_id        int64         
     1   item_id        int64         
     2   behavior_type  int64         
     3   item_category  int64         
     4   time           datetime64[ns]
     5   date           datetime64[ns]
     6   hour           int64         
    dtypes: datetime64[ns](2), int64(5)
    memory usage: 654.6 MB
    


```python
data_user.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>item_id</th>
      <th>behavior_type</th>
      <th>item_category</th>
      <th>time</th>
      <th>date</th>
      <th>hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>98047837</td>
      <td>232431562</td>
      <td>1</td>
      <td>4245</td>
      <td>2014-12-06 02:00:00</td>
      <td>2014-12-06</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>97726136</td>
      <td>383583590</td>
      <td>1</td>
      <td>5894</td>
      <td>2014-12-09 20:00:00</td>
      <td>2014-12-09</td>
      <td>20</td>
    </tr>
    <tr>
      <th>2</th>
      <td>98607707</td>
      <td>64749712</td>
      <td>1</td>
      <td>2883</td>
      <td>2014-12-18 11:00:00</td>
      <td>2014-12-18</td>
      <td>11</td>
    </tr>
    <tr>
      <th>3</th>
      <td>98662432</td>
      <td>320593836</td>
      <td>1</td>
      <td>6562</td>
      <td>2014-12-06 10:00:00</td>
      <td>2014-12-06</td>
      <td>10</td>
    </tr>
    <tr>
      <th>4</th>
      <td>98145908</td>
      <td>290208520</td>
      <td>1</td>
      <td>13926</td>
      <td>2014-12-16 21:00:00</td>
      <td>2014-12-16</td>
      <td>21</td>
    </tr>
  </tbody>
</table>
</div>



# 整体情况概览


```python
print('总浏览量：%d' %len(data_user))
print('总浏览人数：%d' %data_user['user_id'].nunique())
print('总订单数：%d' %data_user[data_user['behavior_type']==4].behavior_type.count())
user_type = data_user.groupby(['user_id']).behavior_type.value_counts().unstack()
pv_nu = user_type[user_type[1] == user_type.sum(axis=1)]
print('跳出率：%.2f%%' %(len(pv_nu)/data_user['user_id'].nunique()*100))
date_rebuy = data_user[data_user.behavior_type==4].groupby('user_id')['date'].apply(lambda x:len(x.unique())).rename('rebuy_count')
print('复购率：%.2f%%' %(date_rebuy[date_rebuy>=2].count()/date_rebuy.count()*100))
```

    总浏览量：12256906
    总浏览人数：10000
    总订单数：120205
    跳出率：3.41%
    复购率：87.17%
    

平均每用户的浏览量为1225次，订单数为12单，跳出率极低，复购率极高，说明用户的忠诚度较高，且在浏览商品时有很强的针对性。

# PV,UV分析


```python
pv_daily=data_user.groupby('date')['user_id'].count().rename('pv').reset_index()
uv_daily=data_user.groupby('date')['user_id'].nunique().rename('uv').reset_index()

```


```python
pv_line=(
    Line(init_opts=opts.InitOpts(width="1000px",height="500px"))
    .add_xaxis(xaxis_data=list(pv_daily.date.astype('str').tolist()))
    .add_yaxis(
        "PV",
        np.around(pv_daily.pv/10000,decimals=2),
        label_opts=opts.LabelOpts(is_show=False)
    )
    .add_yaxis(
        series_name="UV",
        yaxis_index=1,
        y_axis=np.around(uv_daily.uv/1,decimals=2),
        label_opts=opts.LabelOpts(is_show=False),
    )
    .extend_axis(
        yaxis=opts.AxisOpts(
            name="UV",
            type_="value",
            min_=6000,
            max_=10000,
            interval=1000,
            axislabel_opts=opts.LabelOpts(formatter="{value} 人"),
        )
    )
    .set_global_opts(
        tooltip_opts=opts.TooltipOpts(
            is_show=True,trigger="axis",axis_pointer_type="cross"
        ),
        xaxis_opts=opts.AxisOpts(
            type_="category",
            axispointer_opts=opts.AxisPointerOpts(is_show=True,type_="line"),
        ),
        yaxis_opts=opts.AxisOpts(
            name="PV",
            type_="value",
            min_=10,
            max_=80,
            interval=15,
            axislabel_opts=opts.LabelOpts(formatter="{value} 万次"),
            axistick_opts=opts.AxisTickOpts(is_show=True),
            splitline_opts=opts.SplitLineOpts(is_show=True),
        ),
        title_opts=opts.TitleOpts(title="PV,UV情况（按天）",pos_left='left'),
        legend_opts=opts.LegendOpts(is_show=True,pos_top='95%')
    )
)
pv_line.render_notebook()
```





<script>
    require.config({
        paths: {
            'echarts':'https://assets.pyecharts.org/assets/echarts.min'
        }
    });
</script>

        <div id="2ba2058bdff04a9ebcf72e96b5f341e4" style="width:1000px; height:500px;"></div>

<script>
        require(['echarts'], function(echarts) {
                var chart_2ba2058bdff04a9ebcf72e96b5f341e4 = echarts.init(
                    document.getElementById('2ba2058bdff04a9ebcf72e96b5f341e4'), 'white', {renderer: 'canvas'});
                var option_2ba2058bdff04a9ebcf72e96b5f341e4 = {
    "animation": true,
    "animationThreshold": 2000,
    "animationDuration": 1000,
    "animationEasing": "cubicOut",
    "animationDelay": 0,
    "animationDurationUpdate": 300,
    "animationEasingUpdate": "cubicOut",
    "animationDelayUpdate": 0,
    "color": [
        "#c23531",
        "#2f4554",
        "#61a0a8",
        "#d48265",
        "#749f83",
        "#ca8622",
        "#bda29a",
        "#6e7074",
        "#546570",
        "#c4ccd3",
        "#f05b72",
        "#ef5b9c",
        "#f47920",
        "#905a3d",
        "#fab27b",
        "#2a5caa",
        "#444693",
        "#726930",
        "#b2d235",
        "#6d8346",
        "#ac6767",
        "#1d953f",
        "#6950a1",
        "#918597"
    ],
    "series": [
        {
            "type": "line",
            "name": "PV",
            "connectNulls": false,
            "symbolSize": 4,
            "showSymbol": true,
            "smooth": false,
            "clip": true,
            "step": false,
            "data": [
                [
                    "2014-11-18",
                    36.67
                ],
                [
                    "2014-11-19",
                    35.88
                ],
                [
                    "2014-11-20",
                    35.34
                ],
                [
                    "2014-11-21",
                    33.31
                ],
                [
                    "2014-11-22",
                    36.14
                ],
                [
                    "2014-11-23",
                    38.27
                ],
                [
                    "2014-11-24",
                    37.83
                ],
                [
                    "2014-11-25",
                    37.02
                ],
                [
                    "2014-11-26",
                    36.09
                ],
                [
                    "2014-11-27",
                    37.14
                ],
                [
                    "2014-11-28",
                    34.06
                ],
                [
                    "2014-11-29",
                    36.47
                ],
                [
                    "2014-11-30",
                    40.16
                ],
                [
                    "2014-12-01",
                    39.46
                ],
                [
                    "2014-12-02",
                    40.52
                ],
                [
                    "2014-12-03",
                    41.16
                ],
                [
                    "2014-12-04",
                    40.0
                ],
                [
                    "2014-12-05",
                    36.19
                ],
                [
                    "2014-12-06",
                    38.96
                ],
                [
                    "2014-12-07",
                    39.98
                ],
                [
                    "2014-12-08",
                    38.67
                ],
                [
                    "2014-12-09",
                    39.8
                ],
                [
                    "2014-12-10",
                    42.19
                ],
                [
                    "2014-12-11",
                    48.85
                ],
                [
                    "2014-12-12",
                    69.17
                ],
                [
                    "2014-12-13",
                    40.72
                ],
                [
                    "2014-12-14",
                    40.25
                ],
                [
                    "2014-12-15",
                    39.84
                ],
                [
                    "2014-12-16",
                    39.51
                ],
                [
                    "2014-12-17",
                    38.48
                ],
                [
                    "2014-12-18",
                    37.56
                ]
            ],
            "hoverAnimation": true,
            "label": {
                "show": false,
                "position": "top",
                "margin": 8
            },
            "lineStyle": {
                "show": true,
                "width": 1,
                "opacity": 1,
                "curveness": 0,
                "type": "solid"
            },
            "areaStyle": {
                "opacity": 0
            },
            "zlevel": 0,
            "z": 0
        },
        {
            "type": "line",
            "name": "UV",
            "connectNulls": false,
            "yAxisIndex": 1,
            "symbolSize": 4,
            "showSymbol": true,
            "smooth": false,
            "clip": true,
            "step": false,
            "data": [
                [
                    "2014-11-18",
                    6343.0
                ],
                [
                    "2014-11-19",
                    6420.0
                ],
                [
                    "2014-11-20",
                    6333.0
                ],
                [
                    "2014-11-21",
                    6276.0
                ],
                [
                    "2014-11-22",
                    6187.0
                ],
                [
                    "2014-11-23",
                    6373.0
                ],
                [
                    "2014-11-24",
                    6513.0
                ],
                [
                    "2014-11-25",
                    6351.0
                ],
                [
                    "2014-11-26",
                    6357.0
                ],
                [
                    "2014-11-27",
                    6359.0
                ],
                [
                    "2014-11-28",
                    6189.0
                ],
                [
                    "2014-11-29",
                    6224.0
                ],
                [
                    "2014-11-30",
                    6379.0
                ],
                [
                    "2014-12-01",
                    6544.0
                ],
                [
                    "2014-12-02",
                    6550.0
                ],
                [
                    "2014-12-03",
                    6585.0
                ],
                [
                    "2014-12-04",
                    6531.0
                ],
                [
                    "2014-12-05",
                    6367.0
                ],
                [
                    "2014-12-06",
                    6440.0
                ],
                [
                    "2014-12-07",
                    6422.0
                ],
                [
                    "2014-12-08",
                    6564.0
                ],
                [
                    "2014-12-09",
                    6566.0
                ],
                [
                    "2014-12-10",
                    6652.0
                ],
                [
                    "2014-12-11",
                    6894.0
                ],
                [
                    "2014-12-12",
                    7720.0
                ],
                [
                    "2014-12-13",
                    6776.0
                ],
                [
                    "2014-12-14",
                    6668.0
                ],
                [
                    "2014-12-15",
                    6787.0
                ],
                [
                    "2014-12-16",
                    6729.0
                ],
                [
                    "2014-12-17",
                    6643.0
                ],
                [
                    "2014-12-18",
                    6582.0
                ]
            ],
            "hoverAnimation": true,
            "label": {
                "show": false,
                "position": "top",
                "margin": 8
            },
            "lineStyle": {
                "show": true,
                "width": 1,
                "opacity": 1,
                "curveness": 0,
                "type": "solid"
            },
            "areaStyle": {
                "opacity": 0
            },
            "zlevel": 0,
            "z": 0
        }
    ],
    "legend": [
        {
            "data": [
                "PV",
                "UV"
            ],
            "selected": {
                "PV": true,
                "UV": true
            },
            "show": true,
            "top": "95%",
            "padding": 5,
            "itemGap": 10,
            "itemWidth": 25,
            "itemHeight": 14
        }
    ],
    "tooltip": {
        "show": true,
        "trigger": "axis",
        "triggerOn": "mousemove|click",
        "axisPointer": {
            "type": "cross"
        },
        "showContent": true,
        "alwaysShowContent": false,
        "showDelay": 0,
        "hideDelay": 100,
        "textStyle": {
            "fontSize": 14
        },
        "borderWidth": 0,
        "padding": 5
    },
    "xAxis": [
        {
            "type": "category",
            "show": true,
            "scale": false,
            "nameLocation": "end",
            "nameGap": 15,
            "gridIndex": 0,
            "axisPointer": {
                "show": true,
                "type": "line"
            },
            "inverse": false,
            "offset": 0,
            "splitNumber": 5,
            "minInterval": 0,
            "splitLine": {
                "show": false,
                "lineStyle": {
                    "show": true,
                    "width": 1,
                    "opacity": 1,
                    "curveness": 0,
                    "type": "solid"
                }
            },
            "data": [
                "2014-11-18",
                "2014-11-19",
                "2014-11-20",
                "2014-11-21",
                "2014-11-22",
                "2014-11-23",
                "2014-11-24",
                "2014-11-25",
                "2014-11-26",
                "2014-11-27",
                "2014-11-28",
                "2014-11-29",
                "2014-11-30",
                "2014-12-01",
                "2014-12-02",
                "2014-12-03",
                "2014-12-04",
                "2014-12-05",
                "2014-12-06",
                "2014-12-07",
                "2014-12-08",
                "2014-12-09",
                "2014-12-10",
                "2014-12-11",
                "2014-12-12",
                "2014-12-13",
                "2014-12-14",
                "2014-12-15",
                "2014-12-16",
                "2014-12-17",
                "2014-12-18"
            ]
        }
    ],
    "yAxis": [
        {
            "type": "value",
            "name": "PV",
            "show": true,
            "scale": false,
            "nameLocation": "end",
            "nameGap": 15,
            "interval": 15,
            "gridIndex": 0,
            "axisTick": {
                "show": true,
                "alignWithLabel": false,
                "inside": false
            },
            "axisLabel": {
                "show": true,
                "position": "top",
                "margin": 8,
                "formatter": "{value} \u4e07\u6b21"
            },
            "inverse": false,
            "offset": 0,
            "splitNumber": 5,
            "min": 10,
            "max": 80,
            "minInterval": 0,
            "splitLine": {
                "show": true,
                "lineStyle": {
                    "show": true,
                    "width": 1,
                    "opacity": 1,
                    "curveness": 0,
                    "type": "solid"
                }
            }
        },
        {
            "type": "value",
            "name": "UV",
            "show": true,
            "scale": false,
            "nameLocation": "end",
            "nameGap": 15,
            "interval": 1000,
            "gridIndex": 0,
            "axisLabel": {
                "show": true,
                "position": "top",
                "margin": 8,
                "formatter": "{value} \u4eba"
            },
            "inverse": false,
            "offset": 0,
            "splitNumber": 5,
            "min": 6000,
            "max": 10000,
            "minInterval": 0,
            "splitLine": {
                "show": false,
                "lineStyle": {
                    "show": true,
                    "width": 1,
                    "opacity": 1,
                    "curveness": 0,
                    "type": "solid"
                }
            }
        }
    ],
    "title": [
        {
            "text": "PV,UV\u60c5\u51b5\uff08\u6309\u5929\uff09",
            "left": "left",
            "padding": 5,
            "itemGap": 10
        }
    ]
};
                chart_2ba2058bdff04a9ebcf72e96b5f341e4.setOption(option_2ba2058bdff04a9ebcf72e96b5f341e4);
        });
    </script>





```python
pv_hour=data_user.groupby('hour')['user_id'].count().rename('pv').reset_index()
uv_hour=data_user.drop_duplicates(['date','hour','user_id']).groupby('hour')['user_id'].count().rename('uv').reset_index()

```


```python
line=(
    Line(init_opts=opts.InitOpts(width="1000px",height="500px"))
    .add_xaxis(xaxis_data=list(pv_hour.hour.tolist()))
    .add_yaxis(
        "PV",
        np.around(pv_hour.pv/10000,decimals=2),
        label_opts=opts.LabelOpts(is_show=False)
    )
    .add_yaxis(
        series_name="UV",
        yaxis_index=1,
        y_axis=np.around(uv_hour.uv/10000,decimals=2),
        label_opts=opts.LabelOpts(is_show=False),
    )
    .extend_axis(
        yaxis=opts.AxisOpts(
            name="UV",
            type_="value",
            min_=0,
            max_=9,
            interval=1.5,
            axislabel_opts=opts.LabelOpts(formatter="{value} 万人"),
        )
    )
    .set_global_opts(
        tooltip_opts=opts.TooltipOpts(
            is_show=True,trigger="axis",axis_pointer_type="cross"
        ),
        xaxis_opts=opts.AxisOpts(
            type_="category",
            axispointer_opts=opts.AxisPointerOpts(is_show=True,type_="line"),
        ),
        yaxis_opts=opts.AxisOpts(
            name="PV",
            type_="value",
            min_=0,
            max_=120,
            interval=20,
            axislabel_opts=opts.LabelOpts(formatter="{value} 万次"),
            axistick_opts=opts.AxisTickOpts(is_show=True),
            splitline_opts=opts.SplitLineOpts(is_show=True),
        ),
        title_opts=opts.TitleOpts(title="PV,UV情况（按小时）",pos_left='left'),
        legend_opts=opts.LegendOpts(is_show=True,pos_top='95%')
    )
)
line.render_notebook()
```





<script>
    require.config({
        paths: {
            'echarts':'https://assets.pyecharts.org/assets/echarts.min'
        }
    });
</script>

        <div id="865ffa82a5d64c1b9f528f74407888c6" style="width:1000px; height:500px;"></div>

<script>
        require(['echarts'], function(echarts) {
                var chart_865ffa82a5d64c1b9f528f74407888c6 = echarts.init(
                    document.getElementById('865ffa82a5d64c1b9f528f74407888c6'), 'white', {renderer: 'canvas'});
                var option_865ffa82a5d64c1b9f528f74407888c6 = {
    "animation": true,
    "animationThreshold": 2000,
    "animationDuration": 1000,
    "animationEasing": "cubicOut",
    "animationDelay": 0,
    "animationDurationUpdate": 300,
    "animationEasingUpdate": "cubicOut",
    "animationDelayUpdate": 0,
    "color": [
        "#c23531",
        "#2f4554",
        "#61a0a8",
        "#d48265",
        "#749f83",
        "#ca8622",
        "#bda29a",
        "#6e7074",
        "#546570",
        "#c4ccd3",
        "#f05b72",
        "#ef5b9c",
        "#f47920",
        "#905a3d",
        "#fab27b",
        "#2a5caa",
        "#444693",
        "#726930",
        "#b2d235",
        "#6d8346",
        "#ac6767",
        "#1d953f",
        "#6950a1",
        "#918597"
    ],
    "series": [
        {
            "type": "line",
            "name": "PV",
            "connectNulls": false,
            "symbolSize": 4,
            "showSymbol": true,
            "smooth": false,
            "clip": true,
            "step": false,
            "data": [
                [
                    0,
                    51.74
                ],
                [
                    1,
                    26.77
                ],
                [
                    2,
                    14.71
                ],
                [
                    3,
                    9.85
                ],
                [
                    4,
                    8.05
                ],
                [
                    5,
                    8.83
                ],
                [
                    6,
                    15.88
                ],
                [
                    7,
                    28.73
                ],
                [
                    8,
                    39.61
                ],
                [
                    9,
                    48.6
                ],
                [
                    10,
                    55.07
                ],
                [
                    11,
                    52.69
                ],
                [
                    12,
                    53.2
                ],
                [
                    13,
                    59.83
                ],
                [
                    14,
                    59.42
                ],
                [
                    15,
                    59.88
                ],
                [
                    16,
                    57.62
                ],
                [
                    17,
                    50.59
                ],
                [
                    18,
                    54.74
                ],
                [
                    19,
                    73.52
                ],
                [
                    20,
                    93.52
                ],
                [
                    21,
                    109.02
                ],
                [
                    22,
                    108.9
                ],
                [
                    23,
                    84.93
                ]
            ],
            "hoverAnimation": true,
            "label": {
                "show": false,
                "position": "top",
                "margin": 8
            },
            "lineStyle": {
                "show": true,
                "width": 1,
                "opacity": 1,
                "curveness": 0,
                "type": "solid"
            },
            "areaStyle": {
                "opacity": 0
            },
            "zlevel": 0,
            "z": 0
        },
        {
            "type": "line",
            "name": "UV",
            "connectNulls": false,
            "yAxisIndex": 1,
            "symbolSize": 4,
            "showSymbol": true,
            "smooth": false,
            "clip": true,
            "step": false,
            "data": [
                [
                    0,
                    2.14
                ],
                [
                    1,
                    1.07
                ],
                [
                    2,
                    0.58
                ],
                [
                    3,
                    0.4
                ],
                [
                    4,
                    0.34
                ],
                [
                    5,
                    0.44
                ],
                [
                    6,
                    1.03
                ],
                [
                    7,
                    1.95
                ],
                [
                    8,
                    2.68
                ],
                [
                    9,
                    3.18
                ],
                [
                    10,
                    3.58
                ],
                [
                    11,
                    3.57
                ],
                [
                    12,
                    3.68
                ],
                [
                    13,
                    3.75
                ],
                [
                    14,
                    3.61
                ],
                [
                    15,
                    3.59
                ],
                [
                    16,
                    3.57
                ],
                [
                    17,
                    3.42
                ],
                [
                    18,
                    3.51
                ],
                [
                    19,
                    4.15
                ],
                [
                    20,
                    4.7
                ],
                [
                    21,
                    5.08
                ],
                [
                    22,
                    4.77
                ],
                [
                    23,
                    3.5
                ]
            ],
            "hoverAnimation": true,
            "label": {
                "show": false,
                "position": "top",
                "margin": 8
            },
            "lineStyle": {
                "show": true,
                "width": 1,
                "opacity": 1,
                "curveness": 0,
                "type": "solid"
            },
            "areaStyle": {
                "opacity": 0
            },
            "zlevel": 0,
            "z": 0
        }
    ],
    "legend": [
        {
            "data": [
                "PV",
                "UV"
            ],
            "selected": {
                "PV": true,
                "UV": true
            },
            "show": true,
            "top": "95%",
            "padding": 5,
            "itemGap": 10,
            "itemWidth": 25,
            "itemHeight": 14
        }
    ],
    "tooltip": {
        "show": true,
        "trigger": "axis",
        "triggerOn": "mousemove|click",
        "axisPointer": {
            "type": "cross"
        },
        "showContent": true,
        "alwaysShowContent": false,
        "showDelay": 0,
        "hideDelay": 100,
        "textStyle": {
            "fontSize": 14
        },
        "borderWidth": 0,
        "padding": 5
    },
    "xAxis": [
        {
            "type": "category",
            "show": true,
            "scale": false,
            "nameLocation": "end",
            "nameGap": 15,
            "gridIndex": 0,
            "axisPointer": {
                "show": true,
                "type": "line"
            },
            "inverse": false,
            "offset": 0,
            "splitNumber": 5,
            "minInterval": 0,
            "splitLine": {
                "show": false,
                "lineStyle": {
                    "show": true,
                    "width": 1,
                    "opacity": 1,
                    "curveness": 0,
                    "type": "solid"
                }
            },
            "data": [
                0,
                1,
                2,
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                11,
                12,
                13,
                14,
                15,
                16,
                17,
                18,
                19,
                20,
                21,
                22,
                23
            ]
        }
    ],
    "yAxis": [
        {
            "type": "value",
            "name": "PV",
            "show": true,
            "scale": false,
            "nameLocation": "end",
            "nameGap": 15,
            "interval": 20,
            "gridIndex": 0,
            "axisTick": {
                "show": true,
                "alignWithLabel": false,
                "inside": false
            },
            "axisLabel": {
                "show": true,
                "position": "top",
                "margin": 8,
                "formatter": "{value} \u4e07\u6b21"
            },
            "inverse": false,
            "offset": 0,
            "splitNumber": 5,
            "min": 0,
            "max": 120,
            "minInterval": 0,
            "splitLine": {
                "show": true,
                "lineStyle": {
                    "show": true,
                    "width": 1,
                    "opacity": 1,
                    "curveness": 0,
                    "type": "solid"
                }
            }
        },
        {
            "type": "value",
            "name": "UV",
            "show": true,
            "scale": false,
            "nameLocation": "end",
            "nameGap": 15,
            "interval": 1.5,
            "gridIndex": 0,
            "axisLabel": {
                "show": true,
                "position": "top",
                "margin": 8,
                "formatter": "{value} \u4e07\u4eba"
            },
            "inverse": false,
            "offset": 0,
            "splitNumber": 5,
            "min": 0,
            "max": 9,
            "minInterval": 0,
            "splitLine": {
                "show": false,
                "lineStyle": {
                    "show": true,
                    "width": 1,
                    "opacity": 1,
                    "curveness": 0,
                    "type": "solid"
                }
            }
        }
    ],
    "title": [
        {
            "text": "PV,UV\u60c5\u51b5\uff08\u6309\u5c0f\u65f6\uff09",
            "left": "left",
            "padding": 5,
            "itemGap": 10
        }
    ]
};
                chart_865ffa82a5d64c1b9f528f74407888c6.setOption(option_865ffa82a5d64c1b9f528f74407888c6);
        });
    </script>




每天活跃人数大约在6500人左右波动，用户点击数也在每天40万左右波动，在双十二当天两项指标大幅增加，活动结束后又迅速恢复正常水平。

用户最活跃的时间段为18时-24时，整体行为规律与人们日常工作等的时间规律相符，平台活动的宣传推广应重点放在这个时间段。

# 其他指标分析


```python
#用户消费次数分布
data_user_buy = data_user[data_user['behavior_type']==4].groupby('user_id')['behavior_type'].count().reset_index().rename(columns={'behavior_type':'buy_num'})
user_buy = data_user_buy.groupby('buy_num')['user_id'].count()

#用户消费间隔分布
data_day_buy = data_user[data_user['behavior_type']==4].groupby(['user_id','date'])['behavior_type'].count().reset_index(level='date')
data_day_buy.drop(columns='behavior_type',inplace=True)
repeat_buy=data_day_buy.groupby('user_id').date.diff(1).dropna()
repeat_buy=repeat_buy.map(lambda x:x.days).value_counts()

#用户日均消费次数
ARPU_num = data_user[data_user['behavior_type']==4].groupby('date')['user_id'].count().rename('pv').reset_index()
ARPU_num['num'] = ARPU_num['pv']/uv_daily['uv']
del ARPU_num['pv']

```


```python
buy_num = (
    Bar()
    .add_xaxis(user_buy.index.tolist())
    .add_yaxis("",user_buy.values.tolist(),label_opts=opts.LabelOpts(is_show=False))
    .set_global_opts(xaxis_opts=opts.AxisOpts(min_=0, max_=80)
        ,title_opts=opts.TitleOpts(title="用户消费次数分布情况"))
)


repeat_buy_num = (
    Bar()
    .add_xaxis(repeat_buy.index.tolist())
    .add_yaxis("",repeat_buy.values.tolist(),label_opts=opts.LabelOpts(is_show=False))
    .set_global_opts(title_opts=opts.TitleOpts(title="用户复购间隔情况"))
)

arpu_num = (
    Line()
    .add_xaxis(list(ARPU_num.date.astype('str').tolist()))
    .add_yaxis("",np.around(ARPU_num.num.tolist(),2),label_opts=opts.LabelOpts(is_show=False))
    .set_global_opts(title_opts=opts.TitleOpts(title="每用户平均购买量"))
    .set_series_opts(
        label_opts=opts.LabelOpts(is_show=False))
)

tab = Tab()
tab.add(buy_num, "用户消费次数分布情况")
tab.add(repeat_buy_num, "用户复购间隔情况")
tab.add(arpu_num, "每用户平均购买量")
tab.render_notebook()
```





<script>
    require.config({
        paths: {
            'echarts':'https://assets.pyecharts.org/assets/echarts.min'
        }
    });
</script>

    <style>
        .tab {
            overflow: hidden;
            border: 1px solid #ccc;
            background-color: #f1f1f1;
        }

        .tab button {
            background-color: inherit;
            float: left;
            border: none;
            outline: none;
            cursor: pointer;
            padding: 12px 16px;
            transition: 0.3s;
        }

        .tab button:hover {
            background-color: #ddd;
        }

        .tab button.active {
            background-color: #ccc;
        }

        .chart-container {
            display: none;
            padding: 6px 12px;
            border-top: none;
        }
    </style>
<div class="tab">
            <button class="tablinks" onclick="showChart(event, 'dbd217fab8774908a00dd28bc73cbef5')">用户消费次数分布情况</button>
            <button class="tablinks" onclick="showChart(event, '369c20bdaf224b99bc4da9074e5555ca')">用户复购间隔情况</button>
            <button class="tablinks" onclick="showChart(event, 'd894fc33d5934308ae652e1d5fee9ac0')">每用户平均购买量</button>
    </div>

        <div id="dbd217fab8774908a00dd28bc73cbef5" class="chart-container" style="width:900px; height:500px;"></div>
        <div id="369c20bdaf224b99bc4da9074e5555ca" class="chart-container" style="width:900px; height:500px;"></div>
        <div id="d894fc33d5934308ae652e1d5fee9ac0" class="chart-container" style="width:900px; height:500px;"></div>

<script>
        require(['echarts'], function(echarts) {
                var chart_dbd217fab8774908a00dd28bc73cbef5 = echarts.init(
                    document.getElementById('dbd217fab8774908a00dd28bc73cbef5'), 'white', {renderer: 'canvas'});
                var option_dbd217fab8774908a00dd28bc73cbef5 = {
    "animation": true,
    "animationThreshold": 2000,
    "animationDuration": 1000,
    "animationEasing": "cubicOut",
    "animationDelay": 0,
    "animationDurationUpdate": 300,
    "animationEasingUpdate": "cubicOut",
    "animationDelayUpdate": 0,
    "color": [
        "#c23531",
        "#2f4554",
        "#61a0a8",
        "#d48265",
        "#749f83",
        "#ca8622",
        "#bda29a",
        "#6e7074",
        "#546570",
        "#c4ccd3",
        "#f05b72",
        "#ef5b9c",
        "#f47920",
        "#905a3d",
        "#fab27b",
        "#2a5caa",
        "#444693",
        "#726930",
        "#b2d235",
        "#6d8346",
        "#ac6767",
        "#1d953f",
        "#6950a1",
        "#918597"
    ],
    "series": [
        {
            "type": "bar",
            "legendHoverLink": true,
            "data": [
                738,
                673,
                636,
                573,
                498,
                481,
                460,
                429,
                359,
                363,
                313,
                261,
                257,
                196,
                213,
                170,
                177,
                144,
                130,
                111,
                127,
                92,
                110,
                99,
                84,
                79,
                59,
                63,
                59,
                50,
                48,
                41,
                49,
                40,
                33,
                45,
                31,
                39,
                26,
                25,
                25,
                18,
                33,
                29,
                23,
                16,
                17,
                20,
                22,
                15,
                16,
                10,
                13,
                13,
                14,
                16,
                12,
                11,
                11,
                7,
                12,
                4,
                7,
                4,
                9,
                9,
                6,
                5,
                6,
                3,
                3,
                9,
                2,
                2,
                2,
                2,
                2,
                2,
                5,
                1,
                1,
                2,
                1,
                1,
                3,
                1,
                1,
                3,
                3,
                2,
                1,
                1,
                1,
                2,
                1,
                1,
                4,
                1,
                1,
                1,
                1,
                2,
                3,
                1,
                2,
                1,
                2,
                3,
                1,
                2,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                2,
                2,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1
            ],
            "showBackground": false,
            "barMinHeight": 0,
            "barCategoryGap": "20%",
            "barGap": "30%",
            "large": false,
            "largeThreshold": 400,
            "seriesLayoutBy": "column",
            "datasetIndex": 0,
            "clip": true,
            "zlevel": 0,
            "z": 2,
            "label": {
                "show": false,
                "position": "top",
                "margin": 8
            }
        }
    ],
    "legend": [
        {
            "data": [
                ""
            ],
            "selected": {
                "": true
            },
            "show": true,
            "padding": 5,
            "itemGap": 10,
            "itemWidth": 25,
            "itemHeight": 14
        }
    ],
    "tooltip": {
        "show": true,
        "trigger": "item",
        "triggerOn": "mousemove|click",
        "axisPointer": {
            "type": "line"
        },
        "showContent": true,
        "alwaysShowContent": false,
        "showDelay": 0,
        "hideDelay": 100,
        "textStyle": {
            "fontSize": 14
        },
        "borderWidth": 0,
        "padding": 5
    },
    "xAxis": [
        {
            "show": true,
            "scale": false,
            "nameLocation": "end",
            "nameGap": 15,
            "gridIndex": 0,
            "inverse": false,
            "offset": 0,
            "splitNumber": 5,
            "min": 0,
            "max": 80,
            "minInterval": 0,
            "splitLine": {
                "show": false,
                "lineStyle": {
                    "show": true,
                    "width": 1,
                    "opacity": 1,
                    "curveness": 0,
                    "type": "solid"
                }
            },
            "data": [
                1,
                2,
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                11,
                12,
                13,
                14,
                15,
                16,
                17,
                18,
                19,
                20,
                21,
                22,
                23,
                24,
                25,
                26,
                27,
                28,
                29,
                30,
                31,
                32,
                33,
                34,
                35,
                36,
                37,
                38,
                39,
                40,
                41,
                42,
                43,
                44,
                45,
                46,
                47,
                48,
                49,
                50,
                51,
                52,
                53,
                54,
                55,
                56,
                57,
                58,
                59,
                60,
                61,
                62,
                63,
                64,
                65,
                66,
                67,
                68,
                69,
                70,
                71,
                72,
                73,
                75,
                76,
                77,
                78,
                79,
                81,
                82,
                83,
                84,
                85,
                86,
                87,
                88,
                91,
                92,
                93,
                94,
                95,
                96,
                97,
                98,
                99,
                100,
                101,
                103,
                104,
                106,
                107,
                108,
                109,
                110,
                113,
                115,
                116,
                117,
                122,
                125,
                126,
                127,
                128,
                130,
                137,
                142,
                145,
                149,
                151,
                167,
                168,
                225,
                242,
                251,
                441,
                649,
                809
            ]
        }
    ],
    "yAxis": [
        {
            "show": true,
            "scale": false,
            "nameLocation": "end",
            "nameGap": 15,
            "gridIndex": 0,
            "inverse": false,
            "offset": 0,
            "splitNumber": 5,
            "minInterval": 0,
            "splitLine": {
                "show": false,
                "lineStyle": {
                    "show": true,
                    "width": 1,
                    "opacity": 1,
                    "curveness": 0,
                    "type": "solid"
                }
            }
        }
    ],
    "title": [
        {
            "text": "\u7528\u6237\u6d88\u8d39\u6b21\u6570\u5206\u5e03\u60c5\u51b5",
            "padding": 5,
            "itemGap": 10
        }
    ]
};
                chart_dbd217fab8774908a00dd28bc73cbef5.setOption(option_dbd217fab8774908a00dd28bc73cbef5);
                var chart_369c20bdaf224b99bc4da9074e5555ca = echarts.init(
                    document.getElementById('369c20bdaf224b99bc4da9074e5555ca'), 'white', {renderer: 'canvas'});
                var option_369c20bdaf224b99bc4da9074e5555ca = {
    "animation": true,
    "animationThreshold": 2000,
    "animationDuration": 1000,
    "animationEasing": "cubicOut",
    "animationDelay": 0,
    "animationDurationUpdate": 300,
    "animationEasingUpdate": "cubicOut",
    "animationDelayUpdate": 0,
    "color": [
        "#c23531",
        "#2f4554",
        "#61a0a8",
        "#d48265",
        "#749f83",
        "#ca8622",
        "#bda29a",
        "#6e7074",
        "#546570",
        "#c4ccd3",
        "#f05b72",
        "#ef5b9c",
        "#f47920",
        "#905a3d",
        "#fab27b",
        "#2a5caa",
        "#444693",
        "#726930",
        "#b2d235",
        "#6d8346",
        "#ac6767",
        "#1d953f",
        "#6950a1",
        "#918597"
    ],
    "series": [
        {
            "type": "bar",
            "legendHoverLink": true,
            "data": [
                14027,
                7421,
                4849,
                3377,
                2465,
                1813,
                1296,
                1015,
                769,
                603,
                477,
                400,
                350,
                283,
                227,
                201,
                128,
                122,
                117,
                90,
                72,
                59,
                57,
                26,
                24,
                20,
                12,
                7,
                7,
                1
            ],
            "showBackground": false,
            "barMinHeight": 0,
            "barCategoryGap": "20%",
            "barGap": "30%",
            "large": false,
            "largeThreshold": 400,
            "seriesLayoutBy": "column",
            "datasetIndex": 0,
            "clip": true,
            "zlevel": 0,
            "z": 2,
            "label": {
                "show": false,
                "position": "top",
                "margin": 8
            }
        }
    ],
    "legend": [
        {
            "data": [
                ""
            ],
            "selected": {
                "": true
            },
            "show": true,
            "padding": 5,
            "itemGap": 10,
            "itemWidth": 25,
            "itemHeight": 14
        }
    ],
    "tooltip": {
        "show": true,
        "trigger": "item",
        "triggerOn": "mousemove|click",
        "axisPointer": {
            "type": "line"
        },
        "showContent": true,
        "alwaysShowContent": false,
        "showDelay": 0,
        "hideDelay": 100,
        "textStyle": {
            "fontSize": 14
        },
        "borderWidth": 0,
        "padding": 5
    },
    "xAxis": [
        {
            "show": true,
            "scale": false,
            "nameLocation": "end",
            "nameGap": 15,
            "gridIndex": 0,
            "inverse": false,
            "offset": 0,
            "splitNumber": 5,
            "minInterval": 0,
            "splitLine": {
                "show": false,
                "lineStyle": {
                    "show": true,
                    "width": 1,
                    "opacity": 1,
                    "curveness": 0,
                    "type": "solid"
                }
            },
            "data": [
                1,
                2,
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                11,
                12,
                13,
                14,
                15,
                16,
                17,
                18,
                19,
                20,
                21,
                23,
                22,
                24,
                26,
                25,
                27,
                29,
                28,
                30
            ]
        }
    ],
    "yAxis": [
        {
            "show": true,
            "scale": false,
            "nameLocation": "end",
            "nameGap": 15,
            "gridIndex": 0,
            "inverse": false,
            "offset": 0,
            "splitNumber": 5,
            "minInterval": 0,
            "splitLine": {
                "show": false,
                "lineStyle": {
                    "show": true,
                    "width": 1,
                    "opacity": 1,
                    "curveness": 0,
                    "type": "solid"
                }
            }
        }
    ],
    "title": [
        {
            "text": "\u7528\u6237\u590d\u8d2d\u95f4\u9694\u60c5\u51b5",
            "padding": 5,
            "itemGap": 10
        }
    ]
};
                chart_369c20bdaf224b99bc4da9074e5555ca.setOption(option_369c20bdaf224b99bc4da9074e5555ca);
                var chart_d894fc33d5934308ae652e1d5fee9ac0 = echarts.init(
                    document.getElementById('d894fc33d5934308ae652e1d5fee9ac0'), 'white', {renderer: 'canvas'});
                var option_d894fc33d5934308ae652e1d5fee9ac0 = {
    "animation": true,
    "animationThreshold": 2000,
    "animationDuration": 1000,
    "animationEasing": "cubicOut",
    "animationDelay": 0,
    "animationDurationUpdate": 300,
    "animationEasingUpdate": "cubicOut",
    "animationDelayUpdate": 0,
    "color": [
        "#c23531",
        "#2f4554",
        "#61a0a8",
        "#d48265",
        "#749f83",
        "#ca8622",
        "#bda29a",
        "#6e7074",
        "#546570",
        "#c4ccd3",
        "#f05b72",
        "#ef5b9c",
        "#f47920",
        "#905a3d",
        "#fab27b",
        "#2a5caa",
        "#444693",
        "#726930",
        "#b2d235",
        "#6d8346",
        "#ac6767",
        "#1d953f",
        "#6950a1",
        "#918597"
    ],
    "series": [
        {
            "type": "line",
            "connectNulls": false,
            "symbolSize": 4,
            "showSymbol": true,
            "smooth": false,
            "clip": true,
            "step": false,
            "data": [
                [
                    "2014-11-18",
                    0.59
                ],
                [
                    "2014-11-19",
                    0.57
                ],
                [
                    "2014-11-20",
                    0.55
                ],
                [
                    "2014-11-21",
                    0.48
                ],
                [
                    "2014-11-22",
                    0.58
                ],
                [
                    "2014-11-23",
                    0.53
                ],
                [
                    "2014-11-24",
                    0.53
                ],
                [
                    "2014-11-25",
                    0.55
                ],
                [
                    "2014-11-26",
                    0.56
                ],
                [
                    "2014-11-27",
                    0.58
                ],
                [
                    "2014-11-28",
                    0.52
                ],
                [
                    "2014-11-29",
                    0.52
                ],
                [
                    "2014-11-30",
                    0.57
                ],
                [
                    "2014-12-01",
                    0.6
                ],
                [
                    "2014-12-02",
                    0.55
                ],
                [
                    "2014-12-03",
                    0.59
                ],
                [
                    "2014-12-04",
                    0.57
                ],
                [
                    "2014-12-05",
                    0.52
                ],
                [
                    "2014-12-06",
                    0.51
                ],
                [
                    "2014-12-07",
                    0.51
                ],
                [
                    "2014-12-08",
                    0.52
                ],
                [
                    "2014-12-09",
                    0.53
                ],
                [
                    "2014-12-10",
                    0.48
                ],
                [
                    "2014-12-11",
                    0.47
                ],
                [
                    "2014-12-12",
                    1.98
                ],
                [
                    "2014-12-13",
                    0.51
                ],
                [
                    "2014-12-14",
                    0.52
                ],
                [
                    "2014-12-15",
                    0.55
                ],
                [
                    "2014-12-16",
                    0.56
                ],
                [
                    "2014-12-17",
                    0.54
                ],
                [
                    "2014-12-18",
                    0.54
                ]
            ],
            "hoverAnimation": true,
            "label": {
                "show": false,
                "position": "top",
                "margin": 8
            },
            "lineStyle": {
                "show": true,
                "width": 1,
                "opacity": 1,
                "curveness": 0,
                "type": "solid"
            },
            "areaStyle": {
                "opacity": 0
            },
            "zlevel": 0,
            "z": 0,
            "rippleEffect": {
                "show": true,
                "brushType": "stroke",
                "scale": 2.5,
                "period": 4
            }
        }
    ],
    "legend": [
        {
            "data": [
                ""
            ],
            "selected": {
                "": true
            },
            "show": true,
            "padding": 5,
            "itemGap": 10,
            "itemWidth": 25,
            "itemHeight": 14
        }
    ],
    "tooltip": {
        "show": true,
        "trigger": "item",
        "triggerOn": "mousemove|click",
        "axisPointer": {
            "type": "line"
        },
        "showContent": true,
        "alwaysShowContent": false,
        "showDelay": 0,
        "hideDelay": 100,
        "textStyle": {
            "fontSize": 14
        },
        "borderWidth": 0,
        "padding": 5
    },
    "xAxis": [
        {
            "show": true,
            "scale": false,
            "nameLocation": "end",
            "nameGap": 15,
            "gridIndex": 0,
            "inverse": false,
            "offset": 0,
            "splitNumber": 5,
            "minInterval": 0,
            "splitLine": {
                "show": false,
                "lineStyle": {
                    "show": true,
                    "width": 1,
                    "opacity": 1,
                    "curveness": 0,
                    "type": "solid"
                }
            },
            "data": [
                "2014-11-18",
                "2014-11-19",
                "2014-11-20",
                "2014-11-21",
                "2014-11-22",
                "2014-11-23",
                "2014-11-24",
                "2014-11-25",
                "2014-11-26",
                "2014-11-27",
                "2014-11-28",
                "2014-11-29",
                "2014-11-30",
                "2014-12-01",
                "2014-12-02",
                "2014-12-03",
                "2014-12-04",
                "2014-12-05",
                "2014-12-06",
                "2014-12-07",
                "2014-12-08",
                "2014-12-09",
                "2014-12-10",
                "2014-12-11",
                "2014-12-12",
                "2014-12-13",
                "2014-12-14",
                "2014-12-15",
                "2014-12-16",
                "2014-12-17",
                "2014-12-18"
            ]
        }
    ],
    "yAxis": [
        {
            "show": true,
            "scale": false,
            "nameLocation": "end",
            "nameGap": 15,
            "gridIndex": 0,
            "inverse": false,
            "offset": 0,
            "splitNumber": 5,
            "minInterval": 0,
            "splitLine": {
                "show": false,
                "lineStyle": {
                    "show": true,
                    "width": 1,
                    "opacity": 1,
                    "curveness": 0,
                    "type": "solid"
                }
            }
        }
    ],
    "title": [
        {
            "text": "\u6bcf\u7528\u6237\u5e73\u5747\u8d2d\u4e70\u91cf",
            "padding": 5,
            "itemGap": 10
        }
    ]
};
                chart_d894fc33d5934308ae652e1d5fee9ac0.setOption(option_d894fc33d5934308ae652e1d5fee9ac0);
        });
    </script>
<script>
        (function() {
            containers = document.getElementsByClassName("chart-container");
            if(containers.length > 0) {
                containers[0].style.display = "block";
            }
        })()

        function showChart(evt, chartID) {
            let containers = document.getElementsByClassName("chart-container");
            for (let i = 0; i < containers.length; i++) {
                containers[i].style.display = "none";
            }

            let tablinks = document.getElementsByClassName("tablinks");
            for (let i = 0; i < tablinks.length; i++) {
                tablinks[i].className = "tablinks";
            }

            document.getElementById(chartID).style.display = "block";
            evt.currentTarget.className += " active";
        }
    </script>




大部分用户的购买次数在10次之内,消费次数随着消费时间间隔的增加而不断下降，在1-10天之内复购的用户较多，10天之后用户较少再次在平台内进行购买，每用户的平均购买量在0.5左右波动，双十二期间接近2。

# 用户行为转化分析


```python
behavior_count = data_user.groupby(['behavior_type','user_id','item_id'])['item_category'].count().reset_index().rename(columns={'item_category':'total'})
pv_count = behavior_count[behavior_count['behavior_type'] == 1]
fav_count = behavior_count[behavior_count['behavior_type'] == 2]
cart_count = behavior_count[behavior_count['behavior_type'] == 3]
buy_count = behavior_count[behavior_count['behavior_type'] == 4]

all_data = pd.merge(pv_count,fav_count,how='left',on=['user_id','item_id']).rename(columns={'behavior_type_x':'pv','behavior_type_y':'fav','total_x':'total_pv','total_y':'total_fav'})
all_data = pd.merge(all_data,cart_count,how='left',on=['user_id','item_id'])
all_data = pd.merge(all_data,buy_count,how='left',on=['user_id','item_id']).rename(columns={'behavior_type_x':'cart','behavior_type_y':'buy','total_x':'total_cart','total_y':'total_buy'})
all_data = all_data.fillna(0)
all_data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pv</th>
      <th>user_id</th>
      <th>item_id</th>
      <th>total_pv</th>
      <th>fav</th>
      <th>total_fav</th>
      <th>cart</th>
      <th>total_cart</th>
      <th>buy</th>
      <th>total_buy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>4913</td>
      <td>315532</td>
      <td>1</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>4913</td>
      <td>876969</td>
      <td>6</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>4913</td>
      <td>2741340</td>
      <td>1</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>4913</td>
      <td>3007091</td>
      <td>3</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>4913</td>
      <td>4210607</td>
      <td>1</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4677496</th>
      <td>1</td>
      <td>142455899</td>
      <td>402191809</td>
      <td>2</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4677497</th>
      <td>1</td>
      <td>142455899</td>
      <td>402919430</td>
      <td>5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4677498</th>
      <td>1</td>
      <td>142455899</td>
      <td>402935883</td>
      <td>3</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4677499</th>
      <td>1</td>
      <td>142455899</td>
      <td>403718848</td>
      <td>2</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4677500</th>
      <td>1</td>
      <td>142455899</td>
      <td>404500108</td>
      <td>2</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>4677501 rows × 10 columns</p>
</div>




```python
#用户点击—购买路径表
pv_buy = all_data.loc[(all_data['fav']==0)&(all_data['cart']==0)]
#用户点击—收藏—购买路径表
pv_fav_buy = all_data.loc[(all_data['fav']==2)&(all_data['cart']==0)]
#用户点击—加购—购买路径表
pv_cart_buy = all_data.loc[(all_data['fav']==0)&(all_data['cart']==3)]
#用户点击—收藏和加购—购买路径表
pv_fav_cart_buy = all_data.loc[(all_data['fav']==2)&(all_data['cart']==3)]
```


```python
#用户点击—购买转换漏斗
attr_1 = ['点击','购买']
values_1 = [np.around(pv_buy['total_pv'].sum()/pv_buy['total_pv'].sum()*100,2)
        ,np.around(pv_buy['total_buy'].sum()/pv_buy['total_pv'].sum()*100,2)]
pv_buy_rate = (
    Funnel()
    .add("商品", [list(z) for z in zip(attr_1, values_1)],
    )
    .set_global_opts(title_opts=opts.TitleOpts(title="点击—购买转化漏斗"),
    legend_opts=opts.LegendOpts(is_show=True,pos_bottom='90%'))
    .set_series_opts(label_opts=opts.LabelOpts(formatter="{b}: {c}%"))
)


#用户点击—收藏—购买转换漏斗
attr_2 = ['点击','收藏','购买']
values_2 = [np.around(pv_fav_buy['total_pv'].sum()/pv_fav_buy['total_pv'].sum()*100,2)
        ,np.around(pv_fav_buy['total_fav'].sum()/pv_fav_buy['total_pv'].sum()*100,2)
        ,np.around(pv_fav_buy['total_buy'].sum()/pv_fav_buy['total_pv'].sum()*100,2)]
pv_fav_buy_rate = (
    Funnel()
    .add("商品", [list(z) for z in zip(attr_2, values_2)],
    )
    .set_global_opts(title_opts=opts.TitleOpts(title="点击—收藏—购买转化漏斗"),
    legend_opts=opts.LegendOpts(is_show=True,pos_bottom='90%'))
    .set_series_opts(label_opts=opts.LabelOpts(formatter="{b}: {c}%"))
)


#用户点击—加购—购买转换漏斗
attr_3 = ['点击','加入购物车','购买']
values_3 = [np.around(pv_cart_buy['total_pv'].sum()/pv_cart_buy['total_pv'].sum()*100,2)
        ,np.around(pv_cart_buy['total_cart'].sum()/pv_cart_buy['total_pv'].sum()*100,2)
        ,np.around(pv_cart_buy['total_buy'].sum()/pv_cart_buy['total_pv'].sum()*100,2)]
pv_cart_buy_rate = (
    Funnel()
    .add("商品", [list(z) for z in zip(attr_3, values_3)],
    )
    .set_global_opts(title_opts=opts.TitleOpts(title="点击—加入购物车—购买转化漏斗"),
    legend_opts=opts.LegendOpts(is_show=True,pos_bottom='90%'))
    .set_series_opts(label_opts=opts.LabelOpts(formatter="{b}: {c}%"))
)


#用户点击—收藏和加购—购买转换漏斗
attr_4 = ['点击','收藏和加入购物车','购买']
values_4 = [np.around(pv_fav_cart_buy['total_pv'].sum()/pv_fav_cart_buy['total_pv'].sum()*100,2)
        ,np.around((pv_fav_cart_buy['total_cart'].sum()+pv_fav_cart_buy['total_fav'].sum())/pv_fav_cart_buy['total_pv'].sum()*100,2)
        ,np.around(pv_fav_cart_buy['total_buy'].sum()/pv_fav_cart_buy['total_pv'].sum()*100,2)]
pv_fav_cart_buy_rate = (
    Funnel()
    .add("商品", [list(z) for z in zip(attr_4, values_4)],
    )
    .set_global_opts(title_opts=opts.TitleOpts(title="点击—收藏和加入购物车—购买转化漏斗"),
    legend_opts=opts.LegendOpts(is_show=True,pos_bottom='90%'))
    .set_series_opts(label_opts=opts.LabelOpts(formatter="{b}: {c}%"))
)


#可视化各行为路径漏斗图
tab = Tab()
tab.add(pv_buy_rate, "点击—购买转化漏斗")
tab.add(pv_fav_buy_rate, "点击—收藏—购买转化漏斗")
tab.add(pv_cart_buy_rate, "点击—加入购物车—购买转化漏斗")
tab.add(pv_fav_cart_buy_rate, "点击—收藏和加入购物车—购买转化漏斗")
tab.render_notebook()
```





<script>
    require.config({
        paths: {
            'echarts':'https://assets.pyecharts.org/assets/echarts.min'
        }
    });
</script>

    <style>
        .tab {
            overflow: hidden;
            border: 1px solid #ccc;
            background-color: #f1f1f1;
        }

        .tab button {
            background-color: inherit;
            float: left;
            border: none;
            outline: none;
            cursor: pointer;
            padding: 12px 16px;
            transition: 0.3s;
        }

        .tab button:hover {
            background-color: #ddd;
        }

        .tab button.active {
            background-color: #ccc;
        }

        .chart-container {
            display: none;
            padding: 6px 12px;
            border-top: none;
        }
    </style>
<div class="tab">
            <button class="tablinks" onclick="showChart(event, 'c9b1234ea9134ba7809157b64b9508cd')">点击—购买转化漏斗</button>
            <button class="tablinks" onclick="showChart(event, '5fe3cd28426a42bd9b3f8123cfe3641c')">点击—收藏—购买转化漏斗</button>
            <button class="tablinks" onclick="showChart(event, 'd81a1d699fc648bc92ca4834326b9cda')">点击—加入购物车—购买转化漏斗</button>
            <button class="tablinks" onclick="showChart(event, 'beeafec26cf44f0a8a0c78a68f1b7d86')">点击—收藏和加入购物车—购买转化漏斗</button>
    </div>

        <div id="c9b1234ea9134ba7809157b64b9508cd" class="chart-container" style="width:900px; height:500px;"></div>
        <div id="5fe3cd28426a42bd9b3f8123cfe3641c" class="chart-container" style="width:900px; height:500px;"></div>
        <div id="d81a1d699fc648bc92ca4834326b9cda" class="chart-container" style="width:900px; height:500px;"></div>
        <div id="beeafec26cf44f0a8a0c78a68f1b7d86" class="chart-container" style="width:900px; height:500px;"></div>

<script>
        require(['echarts'], function(echarts) {
                var chart_c9b1234ea9134ba7809157b64b9508cd = echarts.init(
                    document.getElementById('c9b1234ea9134ba7809157b64b9508cd'), 'white', {renderer: 'canvas'});
                var option_c9b1234ea9134ba7809157b64b9508cd = {
    "animation": true,
    "animationThreshold": 2000,
    "animationDuration": 1000,
    "animationEasing": "cubicOut",
    "animationDelay": 0,
    "animationDurationUpdate": 300,
    "animationEasingUpdate": "cubicOut",
    "animationDelayUpdate": 0,
    "color": [
        "#c23531",
        "#2f4554",
        "#61a0a8",
        "#d48265",
        "#749f83",
        "#ca8622",
        "#bda29a",
        "#6e7074",
        "#546570",
        "#c4ccd3",
        "#f05b72",
        "#ef5b9c",
        "#f47920",
        "#905a3d",
        "#fab27b",
        "#2a5caa",
        "#444693",
        "#726930",
        "#b2d235",
        "#6d8346",
        "#ac6767",
        "#1d953f",
        "#6950a1",
        "#918597"
    ],
    "series": [
        {
            "type": "funnel",
            "name": "\u5546\u54c1",
            "data": [
                {
                    "name": "\u70b9\u51fb",
                    "value": 100.0
                },
                {
                    "name": "\u8d2d\u4e70",
                    "value": 0.39
                }
            ],
            "sort": "descending",
            "gap": 0,
            "label": {
                "show": true,
                "position": "top",
                "margin": 8,
                "formatter": "{b}: {c}%"
            },
            "rippleEffect": {
                "show": true,
                "brushType": "stroke",
                "scale": 2.5,
                "period": 4
            }
        }
    ],
    "legend": [
        {
            "data": [
                "\u70b9\u51fb",
                "\u8d2d\u4e70"
            ],
            "selected": {
                "\u70b9\u51fb": true,
                "\u8d2d\u4e70": true
            },
            "show": true,
            "bottom": "90%",
            "padding": 5,
            "itemGap": 10,
            "itemWidth": 25,
            "itemHeight": 14
        }
    ],
    "tooltip": {
        "show": true,
        "trigger": "item",
        "triggerOn": "mousemove|click",
        "axisPointer": {
            "type": "line"
        },
        "showContent": true,
        "alwaysShowContent": false,
        "showDelay": 0,
        "hideDelay": 100,
        "textStyle": {
            "fontSize": 14
        },
        "borderWidth": 0,
        "padding": 5
    },
    "title": [
        {
            "text": "\u70b9\u51fb\u2014\u8d2d\u4e70\u8f6c\u5316\u6f0f\u6597",
            "padding": 5,
            "itemGap": 10
        }
    ]
};
                chart_c9b1234ea9134ba7809157b64b9508cd.setOption(option_c9b1234ea9134ba7809157b64b9508cd);
                var chart_5fe3cd28426a42bd9b3f8123cfe3641c = echarts.init(
                    document.getElementById('5fe3cd28426a42bd9b3f8123cfe3641c'), 'white', {renderer: 'canvas'});
                var option_5fe3cd28426a42bd9b3f8123cfe3641c = {
    "animation": true,
    "animationThreshold": 2000,
    "animationDuration": 1000,
    "animationEasing": "cubicOut",
    "animationDelay": 0,
    "animationDurationUpdate": 300,
    "animationEasingUpdate": "cubicOut",
    "animationDelayUpdate": 0,
    "color": [
        "#c23531",
        "#2f4554",
        "#61a0a8",
        "#d48265",
        "#749f83",
        "#ca8622",
        "#bda29a",
        "#6e7074",
        "#546570",
        "#c4ccd3",
        "#f05b72",
        "#ef5b9c",
        "#f47920",
        "#905a3d",
        "#fab27b",
        "#2a5caa",
        "#444693",
        "#726930",
        "#b2d235",
        "#6d8346",
        "#ac6767",
        "#1d953f",
        "#6950a1",
        "#918597"
    ],
    "series": [
        {
            "type": "funnel",
            "name": "\u5546\u54c1",
            "data": [
                {
                    "name": "\u70b9\u51fb",
                    "value": 100.0
                },
                {
                    "name": "\u6536\u85cf",
                    "value": 25.05
                },
                {
                    "name": "\u8d2d\u4e70",
                    "value": 0.68
                }
            ],
            "sort": "descending",
            "gap": 0,
            "label": {
                "show": true,
                "position": "top",
                "margin": 8,
                "formatter": "{b}: {c}%"
            },
            "rippleEffect": {
                "show": true,
                "brushType": "stroke",
                "scale": 2.5,
                "period": 4
            }
        }
    ],
    "legend": [
        {
            "data": [
                "\u70b9\u51fb",
                "\u8d2d\u4e70",
                "\u6536\u85cf"
            ],
            "selected": {
                "\u70b9\u51fb": true,
                "\u6536\u85cf": true,
                "\u8d2d\u4e70": true
            },
            "show": true,
            "bottom": "90%",
            "padding": 5,
            "itemGap": 10,
            "itemWidth": 25,
            "itemHeight": 14
        }
    ],
    "tooltip": {
        "show": true,
        "trigger": "item",
        "triggerOn": "mousemove|click",
        "axisPointer": {
            "type": "line"
        },
        "showContent": true,
        "alwaysShowContent": false,
        "showDelay": 0,
        "hideDelay": 100,
        "textStyle": {
            "fontSize": 14
        },
        "borderWidth": 0,
        "padding": 5
    },
    "title": [
        {
            "text": "\u70b9\u51fb\u2014\u6536\u85cf\u2014\u8d2d\u4e70\u8f6c\u5316\u6f0f\u6597",
            "padding": 5,
            "itemGap": 10
        }
    ]
};
                chart_5fe3cd28426a42bd9b3f8123cfe3641c.setOption(option_5fe3cd28426a42bd9b3f8123cfe3641c);
                var chart_d81a1d699fc648bc92ca4834326b9cda = echarts.init(
                    document.getElementById('d81a1d699fc648bc92ca4834326b9cda'), 'white', {renderer: 'canvas'});
                var option_d81a1d699fc648bc92ca4834326b9cda = {
    "animation": true,
    "animationThreshold": 2000,
    "animationDuration": 1000,
    "animationEasing": "cubicOut",
    "animationDelay": 0,
    "animationDurationUpdate": 300,
    "animationEasingUpdate": "cubicOut",
    "animationDelayUpdate": 0,
    "color": [
        "#c23531",
        "#2f4554",
        "#61a0a8",
        "#d48265",
        "#749f83",
        "#ca8622",
        "#bda29a",
        "#6e7074",
        "#546570",
        "#c4ccd3",
        "#f05b72",
        "#ef5b9c",
        "#f47920",
        "#905a3d",
        "#fab27b",
        "#2a5caa",
        "#444693",
        "#726930",
        "#b2d235",
        "#6d8346",
        "#ac6767",
        "#1d953f",
        "#6950a1",
        "#918597"
    ],
    "series": [
        {
            "type": "funnel",
            "name": "\u5546\u54c1",
            "data": [
                {
                    "name": "\u70b9\u51fb",
                    "value": 100.0
                },
                {
                    "name": "\u52a0\u5165\u8d2d\u7269\u8f66",
                    "value": 22.11
                },
                {
                    "name": "\u8d2d\u4e70",
                    "value": 4.66
                }
            ],
            "sort": "descending",
            "gap": 0,
            "label": {
                "show": true,
                "position": "top",
                "margin": 8,
                "formatter": "{b}: {c}%"
            },
            "rippleEffect": {
                "show": true,
                "brushType": "stroke",
                "scale": 2.5,
                "period": 4
            }
        }
    ],
    "legend": [
        {
            "data": [
                "\u70b9\u51fb",
                "\u52a0\u5165\u8d2d\u7269\u8f66",
                "\u8d2d\u4e70"
            ],
            "selected": {
                "\u70b9\u51fb": true,
                "\u52a0\u5165\u8d2d\u7269\u8f66": true,
                "\u8d2d\u4e70": true
            },
            "show": true,
            "bottom": "90%",
            "padding": 5,
            "itemGap": 10,
            "itemWidth": 25,
            "itemHeight": 14
        }
    ],
    "tooltip": {
        "show": true,
        "trigger": "item",
        "triggerOn": "mousemove|click",
        "axisPointer": {
            "type": "line"
        },
        "showContent": true,
        "alwaysShowContent": false,
        "showDelay": 0,
        "hideDelay": 100,
        "textStyle": {
            "fontSize": 14
        },
        "borderWidth": 0,
        "padding": 5
    },
    "title": [
        {
            "text": "\u70b9\u51fb\u2014\u52a0\u5165\u8d2d\u7269\u8f66\u2014\u8d2d\u4e70\u8f6c\u5316\u6f0f\u6597",
            "padding": 5,
            "itemGap": 10
        }
    ]
};
                chart_d81a1d699fc648bc92ca4834326b9cda.setOption(option_d81a1d699fc648bc92ca4834326b9cda);
                var chart_beeafec26cf44f0a8a0c78a68f1b7d86 = echarts.init(
                    document.getElementById('beeafec26cf44f0a8a0c78a68f1b7d86'), 'white', {renderer: 'canvas'});
                var option_beeafec26cf44f0a8a0c78a68f1b7d86 = {
    "animation": true,
    "animationThreshold": 2000,
    "animationDuration": 1000,
    "animationEasing": "cubicOut",
    "animationDelay": 0,
    "animationDurationUpdate": 300,
    "animationEasingUpdate": "cubicOut",
    "animationDelayUpdate": 0,
    "color": [
        "#c23531",
        "#2f4554",
        "#61a0a8",
        "#d48265",
        "#749f83",
        "#ca8622",
        "#bda29a",
        "#6e7074",
        "#546570",
        "#c4ccd3",
        "#f05b72",
        "#ef5b9c",
        "#f47920",
        "#905a3d",
        "#fab27b",
        "#2a5caa",
        "#444693",
        "#726930",
        "#b2d235",
        "#6d8346",
        "#ac6767",
        "#1d953f",
        "#6950a1",
        "#918597"
    ],
    "series": [
        {
            "type": "funnel",
            "name": "\u5546\u54c1",
            "data": [
                {
                    "name": "\u70b9\u51fb",
                    "value": 100.0
                },
                {
                    "name": "\u6536\u85cf\u548c\u52a0\u5165\u8d2d\u7269\u8f66",
                    "value": 23.23
                },
                {
                    "name": "\u8d2d\u4e70",
                    "value": 4.05
                }
            ],
            "sort": "descending",
            "gap": 0,
            "label": {
                "show": true,
                "position": "top",
                "margin": 8,
                "formatter": "{b}: {c}%"
            },
            "rippleEffect": {
                "show": true,
                "brushType": "stroke",
                "scale": 2.5,
                "period": 4
            }
        }
    ],
    "legend": [
        {
            "data": [
                "\u70b9\u51fb",
                "\u6536\u85cf\u548c\u52a0\u5165\u8d2d\u7269\u8f66",
                "\u8d2d\u4e70"
            ],
            "selected": {
                "\u70b9\u51fb": true,
                "\u6536\u85cf\u548c\u52a0\u5165\u8d2d\u7269\u8f66": true,
                "\u8d2d\u4e70": true
            },
            "show": true,
            "bottom": "90%",
            "padding": 5,
            "itemGap": 10,
            "itemWidth": 25,
            "itemHeight": 14
        }
    ],
    "tooltip": {
        "show": true,
        "trigger": "item",
        "triggerOn": "mousemove|click",
        "axisPointer": {
            "type": "line"
        },
        "showContent": true,
        "alwaysShowContent": false,
        "showDelay": 0,
        "hideDelay": 100,
        "textStyle": {
            "fontSize": 14
        },
        "borderWidth": 0,
        "padding": 5
    },
    "title": [
        {
            "text": "\u70b9\u51fb\u2014\u6536\u85cf\u548c\u52a0\u5165\u8d2d\u7269\u8f66\u2014\u8d2d\u4e70\u8f6c\u5316\u6f0f\u6597",
            "padding": 5,
            "itemGap": 10
        }
    ]
};
                chart_beeafec26cf44f0a8a0c78a68f1b7d86.setOption(option_beeafec26cf44f0a8a0c78a68f1b7d86);
        });
    </script>
<script>
        (function() {
            containers = document.getElementsByClassName("chart-container");
            if(containers.length > 0) {
                containers[0].style.display = "block";
            }
        })()

        function showChart(evt, chartID) {
            let containers = document.getElementsByClassName("chart-container");
            for (let i = 0; i < containers.length; i++) {
                containers[i].style.display = "none";
            }

            let tablinks = document.getElementsByClassName("tablinks");
            for (let i = 0; i < tablinks.length; i++) {
                tablinks[i].className = "tablinks";
            }

            document.getElementById(chartID).style.display = "block";
            evt.currentTarget.className += " active";
        }
    </script>




“点击—加入购物车—购买”的转化率最高，说明加购的的行为是用户购买意向的体现，平台可以根据用户加购列表里的商品开展营销活动。

“点击—收藏—购买”的转化率与“点击—购买”的转化率相当，说明收藏并不能促进用户购买。

# RFM分析 

R:最近一次购买日期  F：一段时间内的购买频率  M：一段时间内的花费金额
因为源数据中没有提供有关M的任何信息，所以只基于R和F两个维度。


```python
data_rfm=data_user[data_user.behavior_type==4].reset_index(drop=True)
recent=data_rfm.date.max() 
data_rfm=data_rfm.groupby(['user_id'],as_index=False).agg({'date': lambda x: (recent - x.max()).days,'time': 'count'}).rename(columns = {'date': 'Recency','time': 'Frequency'})
```


```python
Recency_avg = data_rfm.Recency.mean()
Frequency_avg = data_rfm.Frequency.mean()
data_rfm['user_type'] = 1
data_rfm.loc[(data_rfm['Recency']<Recency_avg)&(data_rfm['Frequency']>Frequency_avg),'user_type'] = '重要价值客户'
data_rfm.loc[(data_rfm['Recency']>Recency_avg)&(data_rfm['Frequency']>Frequency_avg),'user_type'] = '重要保持用户'
data_rfm.loc[(data_rfm['Recency']<Recency_avg)&(data_rfm['Frequency']<Frequency_avg),'user_type'] = '重要发展用户'
data_rfm.loc[(data_rfm['Recency']>Recency_avg)&(data_rfm['Frequency']<Frequency_avg),'user_type'] = '重要挽留用户'
```


```python
rfm=data_rfm.groupby('user_type')['user_id'].count()
rfm
```




    user_type
    重要价值客户    2394
    重要保持用户     451
    重要发展用户    2986
    重要挽留用户    3055
    Name: user_id, dtype: int64




```python
pie = (
    Pie()
    .add(
        '',
        [z for z in zip(rfm.index, rfm.values.tolist())]
    )
    .set_global_opts(title_opts=opts.TitleOpts(title="客户群体分析"),
                     legend_opts=opts.LegendOpts(is_show=True),)
    .set_series_opts(label_opts=opts.LabelOpts(formatter="{b}: {d}%"))
      )
pie.render_notebook()
```





<script>
    require.config({
        paths: {
            'echarts':'https://assets.pyecharts.org/assets/echarts.min'
        }
    });
</script>

        <div id="7d8bc79721174b0091b3b2d61c6bbfbd" style="width:900px; height:500px;"></div>

<script>
        require(['echarts'], function(echarts) {
                var chart_7d8bc79721174b0091b3b2d61c6bbfbd = echarts.init(
                    document.getElementById('7d8bc79721174b0091b3b2d61c6bbfbd'), 'white', {renderer: 'canvas'});
                var option_7d8bc79721174b0091b3b2d61c6bbfbd = {
    "animation": true,
    "animationThreshold": 2000,
    "animationDuration": 1000,
    "animationEasing": "cubicOut",
    "animationDelay": 0,
    "animationDurationUpdate": 300,
    "animationEasingUpdate": "cubicOut",
    "animationDelayUpdate": 0,
    "color": [
        "#c23531",
        "#2f4554",
        "#61a0a8",
        "#d48265",
        "#749f83",
        "#ca8622",
        "#bda29a",
        "#6e7074",
        "#546570",
        "#c4ccd3",
        "#f05b72",
        "#ef5b9c",
        "#f47920",
        "#905a3d",
        "#fab27b",
        "#2a5caa",
        "#444693",
        "#726930",
        "#b2d235",
        "#6d8346",
        "#ac6767",
        "#1d953f",
        "#6950a1",
        "#918597"
    ],
    "series": [
        {
            "type": "pie",
            "clockwise": true,
            "data": [
                {
                    "name": "\u91cd\u8981\u4ef7\u503c\u5ba2\u6237",
                    "value": 2394
                },
                {
                    "name": "\u91cd\u8981\u4fdd\u6301\u7528\u6237",
                    "value": 451
                },
                {
                    "name": "\u91cd\u8981\u53d1\u5c55\u7528\u6237",
                    "value": 2986
                },
                {
                    "name": "\u91cd\u8981\u633d\u7559\u7528\u6237",
                    "value": 3055
                }
            ],
            "radius": [
                "0%",
                "75%"
            ],
            "center": [
                "50%",
                "50%"
            ],
            "label": {
                "show": true,
                "position": "top",
                "margin": 8,
                "formatter": "{b}: {d}%"
            },
            "rippleEffect": {
                "show": true,
                "brushType": "stroke",
                "scale": 2.5,
                "period": 4
            }
        }
    ],
    "legend": [
        {
            "data": [
                "\u91cd\u8981\u4ef7\u503c\u5ba2\u6237",
                "\u91cd\u8981\u4fdd\u6301\u7528\u6237",
                "\u91cd\u8981\u53d1\u5c55\u7528\u6237",
                "\u91cd\u8981\u633d\u7559\u7528\u6237"
            ],
            "selected": {},
            "show": true,
            "padding": 5,
            "itemGap": 10,
            "itemWidth": 25,
            "itemHeight": 14
        }
    ],
    "tooltip": {
        "show": true,
        "trigger": "item",
        "triggerOn": "mousemove|click",
        "axisPointer": {
            "type": "line"
        },
        "showContent": true,
        "alwaysShowContent": false,
        "showDelay": 0,
        "hideDelay": 100,
        "textStyle": {
            "fontSize": 14
        },
        "borderWidth": 0,
        "padding": 5
    },
    "title": [
        {
            "text": "\u5ba2\u6237\u7fa4\u4f53\u5206\u6790",
            "padding": 5,
            "itemGap": 10
        }
    ]
};
                chart_7d8bc79721174b0091b3b2d61c6bbfbd.setOption(option_7d8bc79721174b0091b3b2d61c6bbfbd);
        });
    </script>




重要价值客户：最近有过购买记录，且消费频率很高，需要重点关注这些用户，既要保持其粘性，又要继续激发这些用户的购买欲望。 

重要发展用户：最近有过购买记录，且消费频率不高，应尽量提高其消费次数。

重要保持用户：有一段时间未购物，且消费频率很高，应注重对这些用户的重新唤醒，促进复购。

重要挽留客户：有一段时间未购物，且消费频率不高，若不加以挽留，会有流失的可能，需要进一步研究其兴趣和需求，采取有效的运营策略。

# 双十二期间用户行为分析


```python
data_12 = data_user[(data_user['date'] <='2014-12-13') & (data_user['date'] >='2014-12-11')]

pv_12_num = data_12.groupby('behavior_type').get_group(1).groupby('time').count()['user_id']
fav_12_num = data_12.groupby('behavior_type').get_group(2).groupby('time').count()['user_id']
cart_12_num = data_12.groupby('behavior_type').get_group(3).groupby('time').count()['user_id']
buy_12_num = data_12.groupby('behavior_type').get_group(4).groupby('time').count()['user_id']
num_12 = pd.concat([pv_12_num,fav_12_num,cart_12_num,buy_12_num],axis=1)
num_12.columns =['浏览','收藏','加购物车','购买']
num_12.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>浏览</th>
      <th>收藏</th>
      <th>加购物车</th>
      <th>购买</th>
    </tr>
    <tr>
      <th>time</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2014-12-11 00:00:00</th>
      <td>16151</td>
      <td>302</td>
      <td>437</td>
      <td>83</td>
    </tr>
    <tr>
      <th>2014-12-11 01:00:00</th>
      <td>7518</td>
      <td>182</td>
      <td>231</td>
      <td>31</td>
    </tr>
    <tr>
      <th>2014-12-11 02:00:00</th>
      <td>3969</td>
      <td>69</td>
      <td>108</td>
      <td>17</td>
    </tr>
    <tr>
      <th>2014-12-11 03:00:00</th>
      <td>3118</td>
      <td>38</td>
      <td>57</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2014-12-11 04:00:00</th>
      <td>2313</td>
      <td>70</td>
      <td>74</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>




```python
line_area = (
    Line()
    .add_xaxis(num_12.index.tolist())
    .add_yaxis("浏览", num_12['浏览'].tolist(),yaxis_index=0,label_opts=opts.LabelOpts(is_show=False))
    .add_yaxis("收藏", num_12['收藏'].tolist(), yaxis_index=1,label_opts=opts.LabelOpts(is_show=False))
    .add_yaxis("加购物车", num_12['加购物车'].tolist(),yaxis_index=1,label_opts=opts.LabelOpts(is_show=False))
    .add_yaxis("购买", num_12['购买'].tolist(), yaxis_index=1,label_opts=opts.LabelOpts(is_show=False))
    .extend_axis(
        yaxis=opts.AxisOpts(
            name="次数",
            type_="value",
            min_=0,
            max_=3000,
            interval=500,
        )
    )
    .set_global_opts(
        tooltip_opts=opts.TooltipOpts(
            is_show=True,trigger="axis",axis_pointer_type="cross"
        ),
        xaxis_opts=opts.AxisOpts(
            type_="category",
            axispointer_opts=opts.AxisPointerOpts(is_show=True,type_="line"),
        ),
        yaxis_opts=opts.AxisOpts(
            name="次数",
            type_="value",
            min_=0,
            max_=60000,
            interval=10000,
            axislabel_opts=opts.LabelOpts(formatter="{value}"),
            axistick_opts=opts.AxisTickOpts(is_show=True),
            splitline_opts=opts.SplitLineOpts(is_show=True),
        ),
        title_opts=opts.TitleOpts(title="双十二前后用户各行为情况",pos_left='left'),
        legend_opts=opts.LegendOpts(is_show=True,pos_top='95%')
    )
)
line_area.render_notebook()
```





<script>
    require.config({
        paths: {
            'echarts':'https://assets.pyecharts.org/assets/echarts.min'
        }
    });
</script>

        <div id="fb3083257c284095a7caaa0578773c01" style="width:900px; height:500px;"></div>

<script>
        require(['echarts'], function(echarts) {
                var chart_fb3083257c284095a7caaa0578773c01 = echarts.init(
                    document.getElementById('fb3083257c284095a7caaa0578773c01'), 'white', {renderer: 'canvas'});
                var option_fb3083257c284095a7caaa0578773c01 = {
    "animation": true,
    "animationThreshold": 2000,
    "animationDuration": 1000,
    "animationEasing": "cubicOut",
    "animationDelay": 0,
    "animationDurationUpdate": 300,
    "animationEasingUpdate": "cubicOut",
    "animationDelayUpdate": 0,
    "color": [
        "#c23531",
        "#2f4554",
        "#61a0a8",
        "#d48265",
        "#749f83",
        "#ca8622",
        "#bda29a",
        "#6e7074",
        "#546570",
        "#c4ccd3",
        "#f05b72",
        "#ef5b9c",
        "#f47920",
        "#905a3d",
        "#fab27b",
        "#2a5caa",
        "#444693",
        "#726930",
        "#b2d235",
        "#6d8346",
        "#ac6767",
        "#1d953f",
        "#6950a1",
        "#918597"
    ],
    "series": [
        {
            "type": "line",
            "name": "\u6d4f\u89c8",
            "connectNulls": false,
            "yAxisIndex": 0,
            "symbolSize": 4,
            "showSymbol": true,
            "smooth": false,
            "clip": true,
            "step": false,
            "data": [
                [
                    "2014-12-11T00:00:00",
                    16151
                ],
                [
                    "2014-12-11T01:00:00",
                    7518
                ],
                [
                    "2014-12-11T02:00:00",
                    3969
                ],
                [
                    "2014-12-11T03:00:00",
                    3118
                ],
                [
                    "2014-12-11T04:00:00",
                    2313
                ],
                [
                    "2014-12-11T05:00:00",
                    2690
                ],
                [
                    "2014-12-11T06:00:00",
                    4940
                ],
                [
                    "2014-12-11T07:00:00",
                    9112
                ],
                [
                    "2014-12-11T08:00:00",
                    11419
                ],
                [
                    "2014-12-11T09:00:00",
                    15743
                ],
                [
                    "2014-12-11T10:00:00",
                    17477
                ],
                [
                    "2014-12-11T11:00:00",
                    18632
                ],
                [
                    "2014-12-11T12:00:00",
                    18504
                ],
                [
                    "2014-12-11T13:00:00",
                    21515
                ],
                [
                    "2014-12-11T14:00:00",
                    21094
                ],
                [
                    "2014-12-11T15:00:00",
                    20597
                ],
                [
                    "2014-12-11T16:00:00",
                    18457
                ],
                [
                    "2014-12-11T17:00:00",
                    18068
                ],
                [
                    "2014-12-11T18:00:00",
                    19973
                ],
                [
                    "2014-12-11T19:00:00",
                    29546
                ],
                [
                    "2014-12-11T20:00:00",
                    36739
                ],
                [
                    "2014-12-11T21:00:00",
                    45095
                ],
                [
                    "2014-12-11T22:00:00",
                    51508
                ],
                [
                    "2014-12-11T23:00:00",
                    46151
                ],
                [
                    "2014-12-12T00:00:00",
                    45229
                ],
                [
                    "2014-12-12T01:00:00",
                    20988
                ],
                [
                    "2014-12-12T02:00:00",
                    10896
                ],
                [
                    "2014-12-12T03:00:00",
                    5762
                ],
                [
                    "2014-12-12T04:00:00",
                    4827
                ],
                [
                    "2014-12-12T05:00:00",
                    6050
                ],
                [
                    "2014-12-12T06:00:00",
                    11997
                ],
                [
                    "2014-12-12T07:00:00",
                    20502
                ],
                [
                    "2014-12-12T08:00:00",
                    25891
                ],
                [
                    "2014-12-12T09:00:00",
                    30066
                ],
                [
                    "2014-12-12T10:00:00",
                    30083
                ],
                [
                    "2014-12-12T11:00:00",
                    25787
                ],
                [
                    "2014-12-12T12:00:00",
                    27963
                ],
                [
                    "2014-12-12T13:00:00",
                    30809
                ],
                [
                    "2014-12-12T14:00:00",
                    27803
                ],
                [
                    "2014-12-12T15:00:00",
                    27660
                ],
                [
                    "2014-12-12T16:00:00",
                    27792
                ],
                [
                    "2014-12-12T17:00:00",
                    23876
                ],
                [
                    "2014-12-12T18:00:00",
                    25121
                ],
                [
                    "2014-12-12T19:00:00",
                    32965
                ],
                [
                    "2014-12-12T20:00:00",
                    40770
                ],
                [
                    "2014-12-12T21:00:00",
                    47831
                ],
                [
                    "2014-12-12T22:00:00",
                    47748
                ],
                [
                    "2014-12-12T23:00:00",
                    43091
                ],
                [
                    "2014-12-13T00:00:00",
                    21749
                ],
                [
                    "2014-12-13T01:00:00",
                    9626
                ],
                [
                    "2014-12-13T02:00:00",
                    4952
                ],
                [
                    "2014-12-13T03:00:00",
                    3650
                ],
                [
                    "2014-12-13T04:00:00",
                    2173
                ],
                [
                    "2014-12-13T05:00:00",
                    2132
                ],
                [
                    "2014-12-13T06:00:00",
                    5584
                ],
                [
                    "2014-12-13T07:00:00",
                    10799
                ],
                [
                    "2014-12-13T08:00:00",
                    15094
                ],
                [
                    "2014-12-13T09:00:00",
                    16328
                ],
                [
                    "2014-12-13T10:00:00",
                    17454
                ],
                [
                    "2014-12-13T11:00:00",
                    15259
                ],
                [
                    "2014-12-13T12:00:00",
                    16666
                ],
                [
                    "2014-12-13T13:00:00",
                    16923
                ],
                [
                    "2014-12-13T14:00:00",
                    17473
                ],
                [
                    "2014-12-13T15:00:00",
                    15861
                ],
                [
                    "2014-12-13T16:00:00",
                    15711
                ],
                [
                    "2014-12-13T17:00:00",
                    16509
                ],
                [
                    "2014-12-13T18:00:00",
                    17665
                ],
                [
                    "2014-12-13T19:00:00",
                    21845
                ],
                [
                    "2014-12-13T20:00:00",
                    29335
                ],
                [
                    "2014-12-13T21:00:00",
                    33934
                ],
                [
                    "2014-12-13T22:00:00",
                    32010
                ],
                [
                    "2014-12-13T23:00:00",
                    26605
                ]
            ],
            "hoverAnimation": true,
            "label": {
                "show": false,
                "position": "top",
                "margin": 8
            },
            "lineStyle": {
                "show": true,
                "width": 1,
                "opacity": 1,
                "curveness": 0,
                "type": "solid"
            },
            "areaStyle": {
                "opacity": 0
            },
            "zlevel": 0,
            "z": 0
        },
        {
            "type": "line",
            "name": "\u6536\u85cf",
            "connectNulls": false,
            "yAxisIndex": 1,
            "symbolSize": 4,
            "showSymbol": true,
            "smooth": false,
            "clip": true,
            "step": false,
            "data": [
                [
                    "2014-12-11T00:00:00",
                    302
                ],
                [
                    "2014-12-11T01:00:00",
                    182
                ],
                [
                    "2014-12-11T02:00:00",
                    69
                ],
                [
                    "2014-12-11T03:00:00",
                    38
                ],
                [
                    "2014-12-11T04:00:00",
                    70
                ],
                [
                    "2014-12-11T05:00:00",
                    79
                ],
                [
                    "2014-12-11T06:00:00",
                    125
                ],
                [
                    "2014-12-11T07:00:00",
                    220
                ],
                [
                    "2014-12-11T08:00:00",
                    221
                ],
                [
                    "2014-12-11T09:00:00",
                    358
                ],
                [
                    "2014-12-11T10:00:00",
                    449
                ],
                [
                    "2014-12-11T11:00:00",
                    466
                ],
                [
                    "2014-12-11T12:00:00",
                    367
                ],
                [
                    "2014-12-11T13:00:00",
                    525
                ],
                [
                    "2014-12-11T14:00:00",
                    419
                ],
                [
                    "2014-12-11T15:00:00",
                    346
                ],
                [
                    "2014-12-11T16:00:00",
                    373
                ],
                [
                    "2014-12-11T17:00:00",
                    333
                ],
                [
                    "2014-12-11T18:00:00",
                    344
                ],
                [
                    "2014-12-11T19:00:00",
                    652
                ],
                [
                    "2014-12-11T20:00:00",
                    684
                ],
                [
                    "2014-12-11T21:00:00",
                    784
                ],
                [
                    "2014-12-11T22:00:00",
                    946
                ],
                [
                    "2014-12-11T23:00:00",
                    958
                ],
                [
                    "2014-12-12T00:00:00",
                    584
                ],
                [
                    "2014-12-12T01:00:00",
                    251
                ],
                [
                    "2014-12-12T02:00:00",
                    194
                ],
                [
                    "2014-12-12T03:00:00",
                    96
                ],
                [
                    "2014-12-12T04:00:00",
                    69
                ],
                [
                    "2014-12-12T05:00:00",
                    82
                ],
                [
                    "2014-12-12T06:00:00",
                    185
                ],
                [
                    "2014-12-12T07:00:00",
                    434
                ],
                [
                    "2014-12-12T08:00:00",
                    426
                ],
                [
                    "2014-12-12T09:00:00",
                    511
                ],
                [
                    "2014-12-12T10:00:00",
                    470
                ],
                [
                    "2014-12-12T11:00:00",
                    402
                ],
                [
                    "2014-12-12T12:00:00",
                    469
                ],
                [
                    "2014-12-12T13:00:00",
                    427
                ],
                [
                    "2014-12-12T14:00:00",
                    516
                ],
                [
                    "2014-12-12T15:00:00",
                    507
                ],
                [
                    "2014-12-12T16:00:00",
                    483
                ],
                [
                    "2014-12-12T17:00:00",
                    387
                ],
                [
                    "2014-12-12T18:00:00",
                    564
                ],
                [
                    "2014-12-12T19:00:00",
                    711
                ],
                [
                    "2014-12-12T20:00:00",
                    565
                ],
                [
                    "2014-12-12T21:00:00",
                    735
                ],
                [
                    "2014-12-12T22:00:00",
                    709
                ],
                [
                    "2014-12-12T23:00:00",
                    669
                ],
                [
                    "2014-12-13T00:00:00",
                    439
                ],
                [
                    "2014-12-13T01:00:00",
                    212
                ],
                [
                    "2014-12-13T02:00:00",
                    86
                ],
                [
                    "2014-12-13T03:00:00",
                    127
                ],
                [
                    "2014-12-13T04:00:00",
                    40
                ],
                [
                    "2014-12-13T05:00:00",
                    34
                ],
                [
                    "2014-12-13T06:00:00",
                    133
                ],
                [
                    "2014-12-13T07:00:00",
                    230
                ],
                [
                    "2014-12-13T08:00:00",
                    337
                ],
                [
                    "2014-12-13T09:00:00",
                    439
                ],
                [
                    "2014-12-13T10:00:00",
                    369
                ],
                [
                    "2014-12-13T11:00:00",
                    334
                ],
                [
                    "2014-12-13T12:00:00",
                    341
                ],
                [
                    "2014-12-13T13:00:00",
                    276
                ],
                [
                    "2014-12-13T14:00:00",
                    327
                ],
                [
                    "2014-12-13T15:00:00",
                    380
                ],
                [
                    "2014-12-13T16:00:00",
                    306
                ],
                [
                    "2014-12-13T17:00:00",
                    270
                ],
                [
                    "2014-12-13T18:00:00",
                    318
                ],
                [
                    "2014-12-13T19:00:00",
                    469
                ],
                [
                    "2014-12-13T20:00:00",
                    564
                ],
                [
                    "2014-12-13T21:00:00",
                    620
                ],
                [
                    "2014-12-13T22:00:00",
                    559
                ],
                [
                    "2014-12-13T23:00:00",
                    649
                ]
            ],
            "hoverAnimation": true,
            "label": {
                "show": false,
                "position": "top",
                "margin": 8
            },
            "lineStyle": {
                "show": true,
                "width": 1,
                "opacity": 1,
                "curveness": 0,
                "type": "solid"
            },
            "areaStyle": {
                "opacity": 0
            },
            "zlevel": 0,
            "z": 0
        },
        {
            "type": "line",
            "name": "\u52a0\u8d2d\u7269\u8f66",
            "connectNulls": false,
            "yAxisIndex": 1,
            "symbolSize": 4,
            "showSymbol": true,
            "smooth": false,
            "clip": true,
            "step": false,
            "data": [
                [
                    "2014-12-11T00:00:00",
                    437
                ],
                [
                    "2014-12-11T01:00:00",
                    231
                ],
                [
                    "2014-12-11T02:00:00",
                    108
                ],
                [
                    "2014-12-11T03:00:00",
                    57
                ],
                [
                    "2014-12-11T04:00:00",
                    74
                ],
                [
                    "2014-12-11T05:00:00",
                    54
                ],
                [
                    "2014-12-11T06:00:00",
                    121
                ],
                [
                    "2014-12-11T07:00:00",
                    227
                ],
                [
                    "2014-12-11T08:00:00",
                    312
                ],
                [
                    "2014-12-11T09:00:00",
                    480
                ],
                [
                    "2014-12-11T10:00:00",
                    569
                ],
                [
                    "2014-12-11T11:00:00",
                    577
                ],
                [
                    "2014-12-11T12:00:00",
                    537
                ],
                [
                    "2014-12-11T13:00:00",
                    599
                ],
                [
                    "2014-12-11T14:00:00",
                    754
                ],
                [
                    "2014-12-11T15:00:00",
                    678
                ],
                [
                    "2014-12-11T16:00:00",
                    638
                ],
                [
                    "2014-12-11T17:00:00",
                    703
                ],
                [
                    "2014-12-11T18:00:00",
                    651
                ],
                [
                    "2014-12-11T19:00:00",
                    984
                ],
                [
                    "2014-12-11T20:00:00",
                    1232
                ],
                [
                    "2014-12-11T21:00:00",
                    1640
                ],
                [
                    "2014-12-11T22:00:00",
                    2011
                ],
                [
                    "2014-12-11T23:00:00",
                    1969
                ],
                [
                    "2014-12-12T00:00:00",
                    2267
                ],
                [
                    "2014-12-12T01:00:00",
                    914
                ],
                [
                    "2014-12-12T02:00:00",
                    442
                ],
                [
                    "2014-12-12T03:00:00",
                    199
                ],
                [
                    "2014-12-12T04:00:00",
                    186
                ],
                [
                    "2014-12-12T05:00:00",
                    185
                ],
                [
                    "2014-12-12T06:00:00",
                    360
                ],
                [
                    "2014-12-12T07:00:00",
                    730
                ],
                [
                    "2014-12-12T08:00:00",
                    1028
                ],
                [
                    "2014-12-12T09:00:00",
                    1252
                ],
                [
                    "2014-12-12T10:00:00",
                    1254
                ],
                [
                    "2014-12-12T11:00:00",
                    1001
                ],
                [
                    "2014-12-12T12:00:00",
                    945
                ],
                [
                    "2014-12-12T13:00:00",
                    1163
                ],
                [
                    "2014-12-12T14:00:00",
                    951
                ],
                [
                    "2014-12-12T15:00:00",
                    989
                ],
                [
                    "2014-12-12T16:00:00",
                    1000
                ],
                [
                    "2014-12-12T17:00:00",
                    869
                ],
                [
                    "2014-12-12T18:00:00",
                    956
                ],
                [
                    "2014-12-12T19:00:00",
                    985
                ],
                [
                    "2014-12-12T20:00:00",
                    1228
                ],
                [
                    "2014-12-12T21:00:00",
                    1843
                ],
                [
                    "2014-12-12T22:00:00",
                    1895
                ],
                [
                    "2014-12-12T23:00:00",
                    1866
                ],
                [
                    "2014-12-13T00:00:00",
                    634
                ],
                [
                    "2014-12-13T01:00:00",
                    233
                ],
                [
                    "2014-12-13T02:00:00",
                    106
                ],
                [
                    "2014-12-13T03:00:00",
                    73
                ],
                [
                    "2014-12-13T04:00:00",
                    60
                ],
                [
                    "2014-12-13T05:00:00",
                    67
                ],
                [
                    "2014-12-13T06:00:00",
                    133
                ],
                [
                    "2014-12-13T07:00:00",
                    254
                ],
                [
                    "2014-12-13T08:00:00",
                    359
                ],
                [
                    "2014-12-13T09:00:00",
                    408
                ],
                [
                    "2014-12-13T10:00:00",
                    540
                ],
                [
                    "2014-12-13T11:00:00",
                    437
                ],
                [
                    "2014-12-13T12:00:00",
                    495
                ],
                [
                    "2014-12-13T13:00:00",
                    517
                ],
                [
                    "2014-12-13T14:00:00",
                    470
                ],
                [
                    "2014-12-13T15:00:00",
                    533
                ],
                [
                    "2014-12-13T16:00:00",
                    432
                ],
                [
                    "2014-12-13T17:00:00",
                    434
                ],
                [
                    "2014-12-13T18:00:00",
                    494
                ],
                [
                    "2014-12-13T19:00:00",
                    530
                ],
                [
                    "2014-12-13T20:00:00",
                    701
                ],
                [
                    "2014-12-13T21:00:00",
                    887
                ],
                [
                    "2014-12-13T22:00:00",
                    858
                ],
                [
                    "2014-12-13T23:00:00",
                    831
                ]
            ],
            "hoverAnimation": true,
            "label": {
                "show": false,
                "position": "top",
                "margin": 8
            },
            "lineStyle": {
                "show": true,
                "width": 1,
                "opacity": 1,
                "curveness": 0,
                "type": "solid"
            },
            "areaStyle": {
                "opacity": 0
            },
            "zlevel": 0,
            "z": 0
        },
        {
            "type": "line",
            "name": "\u8d2d\u4e70",
            "connectNulls": false,
            "yAxisIndex": 1,
            "symbolSize": 4,
            "showSymbol": true,
            "smooth": false,
            "clip": true,
            "step": false,
            "data": [
                [
                    "2014-12-11T00:00:00",
                    83
                ],
                [
                    "2014-12-11T01:00:00",
                    31
                ],
                [
                    "2014-12-11T02:00:00",
                    17
                ],
                [
                    "2014-12-11T03:00:00",
                    9
                ],
                [
                    "2014-12-11T04:00:00",
                    4
                ],
                [
                    "2014-12-11T05:00:00",
                    7
                ],
                [
                    "2014-12-11T06:00:00",
                    23
                ],
                [
                    "2014-12-11T07:00:00",
                    32
                ],
                [
                    "2014-12-11T08:00:00",
                    65
                ],
                [
                    "2014-12-11T09:00:00",
                    111
                ],
                [
                    "2014-12-11T10:00:00",
                    138
                ],
                [
                    "2014-12-11T11:00:00",
                    199
                ],
                [
                    "2014-12-11T12:00:00",
                    191
                ],
                [
                    "2014-12-11T13:00:00",
                    204
                ],
                [
                    "2014-12-11T14:00:00",
                    201
                ],
                [
                    "2014-12-11T15:00:00",
                    279
                ],
                [
                    "2014-12-11T16:00:00",
                    142
                ],
                [
                    "2014-12-11T17:00:00",
                    116
                ],
                [
                    "2014-12-11T18:00:00",
                    154
                ],
                [
                    "2014-12-11T19:00:00",
                    144
                ],
                [
                    "2014-12-11T20:00:00",
                    263
                ],
                [
                    "2014-12-11T21:00:00",
                    283
                ],
                [
                    "2014-12-11T22:00:00",
                    332
                ],
                [
                    "2014-12-11T23:00:00",
                    198
                ],
                [
                    "2014-12-12T00:00:00",
                    1950
                ],
                [
                    "2014-12-12T01:00:00",
                    608
                ],
                [
                    "2014-12-12T02:00:00",
                    222
                ],
                [
                    "2014-12-12T03:00:00",
                    116
                ],
                [
                    "2014-12-12T04:00:00",
                    86
                ],
                [
                    "2014-12-12T05:00:00",
                    100
                ],
                [
                    "2014-12-12T06:00:00",
                    278
                ],
                [
                    "2014-12-12T07:00:00",
                    511
                ],
                [
                    "2014-12-12T08:00:00",
                    811
                ],
                [
                    "2014-12-12T09:00:00",
                    866
                ],
                [
                    "2014-12-12T10:00:00",
                    824
                ],
                [
                    "2014-12-12T11:00:00",
                    839
                ],
                [
                    "2014-12-12T12:00:00",
                    681
                ],
                [
                    "2014-12-12T13:00:00",
                    737
                ],
                [
                    "2014-12-12T14:00:00",
                    570
                ],
                [
                    "2014-12-12T15:00:00",
                    588
                ],
                [
                    "2014-12-12T16:00:00",
                    597
                ],
                [
                    "2014-12-12T17:00:00",
                    438
                ],
                [
                    "2014-12-12T18:00:00",
                    424
                ],
                [
                    "2014-12-12T19:00:00",
                    577
                ],
                [
                    "2014-12-12T20:00:00",
                    643
                ],
                [
                    "2014-12-12T21:00:00",
                    850
                ],
                [
                    "2014-12-12T22:00:00",
                    985
                ],
                [
                    "2014-12-12T23:00:00",
                    950
                ],
                [
                    "2014-12-13T00:00:00",
                    195
                ],
                [
                    "2014-12-13T01:00:00",
                    36
                ],
                [
                    "2014-12-13T02:00:00",
                    18
                ],
                [
                    "2014-12-13T03:00:00",
                    9
                ],
                [
                    "2014-12-13T04:00:00",
                    11
                ],
                [
                    "2014-12-13T05:00:00",
                    16
                ],
                [
                    "2014-12-13T06:00:00",
                    36
                ],
                [
                    "2014-12-13T07:00:00",
                    59
                ],
                [
                    "2014-12-13T08:00:00",
                    72
                ],
                [
                    "2014-12-13T09:00:00",
                    147
                ],
                [
                    "2014-12-13T10:00:00",
                    194
                ],
                [
                    "2014-12-13T11:00:00",
                    168
                ],
                [
                    "2014-12-13T12:00:00",
                    196
                ],
                [
                    "2014-12-13T13:00:00",
                    284
                ],
                [
                    "2014-12-13T14:00:00",
                    205
                ],
                [
                    "2014-12-13T15:00:00",
                    231
                ],
                [
                    "2014-12-13T16:00:00",
                    192
                ],
                [
                    "2014-12-13T17:00:00",
                    192
                ],
                [
                    "2014-12-13T18:00:00",
                    138
                ],
                [
                    "2014-12-13T19:00:00",
                    148
                ],
                [
                    "2014-12-13T20:00:00",
                    245
                ],
                [
                    "2014-12-13T21:00:00",
                    306
                ],
                [
                    "2014-12-13T22:00:00",
                    230
                ],
                [
                    "2014-12-13T23:00:00",
                    150
                ]
            ],
            "hoverAnimation": true,
            "label": {
                "show": false,
                "position": "top",
                "margin": 8
            },
            "lineStyle": {
                "show": true,
                "width": 1,
                "opacity": 1,
                "curveness": 0,
                "type": "solid"
            },
            "areaStyle": {
                "opacity": 0
            },
            "zlevel": 0,
            "z": 0
        }
    ],
    "legend": [
        {
            "data": [
                "\u6d4f\u89c8",
                "\u6536\u85cf",
                "\u52a0\u8d2d\u7269\u8f66",
                "\u8d2d\u4e70"
            ],
            "selected": {
                "\u6d4f\u89c8": true,
                "\u6536\u85cf": true,
                "\u52a0\u8d2d\u7269\u8f66": true,
                "\u8d2d\u4e70": true
            },
            "show": true,
            "top": "95%",
            "padding": 5,
            "itemGap": 10,
            "itemWidth": 25,
            "itemHeight": 14
        }
    ],
    "tooltip": {
        "show": true,
        "trigger": "axis",
        "triggerOn": "mousemove|click",
        "axisPointer": {
            "type": "cross"
        },
        "showContent": true,
        "alwaysShowContent": false,
        "showDelay": 0,
        "hideDelay": 100,
        "textStyle": {
            "fontSize": 14
        },
        "borderWidth": 0,
        "padding": 5
    },
    "xAxis": [
        {
            "type": "category",
            "show": true,
            "scale": false,
            "nameLocation": "end",
            "nameGap": 15,
            "gridIndex": 0,
            "axisPointer": {
                "show": true,
                "type": "line"
            },
            "inverse": false,
            "offset": 0,
            "splitNumber": 5,
            "minInterval": 0,
            "splitLine": {
                "show": false,
                "lineStyle": {
                    "show": true,
                    "width": 1,
                    "opacity": 1,
                    "curveness": 0,
                    "type": "solid"
                }
            },
            "data": [
                "2014-12-11T00:00:00",
                "2014-12-11T01:00:00",
                "2014-12-11T02:00:00",
                "2014-12-11T03:00:00",
                "2014-12-11T04:00:00",
                "2014-12-11T05:00:00",
                "2014-12-11T06:00:00",
                "2014-12-11T07:00:00",
                "2014-12-11T08:00:00",
                "2014-12-11T09:00:00",
                "2014-12-11T10:00:00",
                "2014-12-11T11:00:00",
                "2014-12-11T12:00:00",
                "2014-12-11T13:00:00",
                "2014-12-11T14:00:00",
                "2014-12-11T15:00:00",
                "2014-12-11T16:00:00",
                "2014-12-11T17:00:00",
                "2014-12-11T18:00:00",
                "2014-12-11T19:00:00",
                "2014-12-11T20:00:00",
                "2014-12-11T21:00:00",
                "2014-12-11T22:00:00",
                "2014-12-11T23:00:00",
                "2014-12-12T00:00:00",
                "2014-12-12T01:00:00",
                "2014-12-12T02:00:00",
                "2014-12-12T03:00:00",
                "2014-12-12T04:00:00",
                "2014-12-12T05:00:00",
                "2014-12-12T06:00:00",
                "2014-12-12T07:00:00",
                "2014-12-12T08:00:00",
                "2014-12-12T09:00:00",
                "2014-12-12T10:00:00",
                "2014-12-12T11:00:00",
                "2014-12-12T12:00:00",
                "2014-12-12T13:00:00",
                "2014-12-12T14:00:00",
                "2014-12-12T15:00:00",
                "2014-12-12T16:00:00",
                "2014-12-12T17:00:00",
                "2014-12-12T18:00:00",
                "2014-12-12T19:00:00",
                "2014-12-12T20:00:00",
                "2014-12-12T21:00:00",
                "2014-12-12T22:00:00",
                "2014-12-12T23:00:00",
                "2014-12-13T00:00:00",
                "2014-12-13T01:00:00",
                "2014-12-13T02:00:00",
                "2014-12-13T03:00:00",
                "2014-12-13T04:00:00",
                "2014-12-13T05:00:00",
                "2014-12-13T06:00:00",
                "2014-12-13T07:00:00",
                "2014-12-13T08:00:00",
                "2014-12-13T09:00:00",
                "2014-12-13T10:00:00",
                "2014-12-13T11:00:00",
                "2014-12-13T12:00:00",
                "2014-12-13T13:00:00",
                "2014-12-13T14:00:00",
                "2014-12-13T15:00:00",
                "2014-12-13T16:00:00",
                "2014-12-13T17:00:00",
                "2014-12-13T18:00:00",
                "2014-12-13T19:00:00",
                "2014-12-13T20:00:00",
                "2014-12-13T21:00:00",
                "2014-12-13T22:00:00",
                "2014-12-13T23:00:00"
            ]
        }
    ],
    "yAxis": [
        {
            "type": "value",
            "name": "\u6b21\u6570",
            "show": true,
            "scale": false,
            "nameLocation": "end",
            "nameGap": 15,
            "interval": 10000,
            "gridIndex": 0,
            "axisTick": {
                "show": true,
                "alignWithLabel": false,
                "inside": false
            },
            "axisLabel": {
                "show": true,
                "position": "top",
                "margin": 8,
                "formatter": "{value}"
            },
            "inverse": false,
            "offset": 0,
            "splitNumber": 5,
            "min": 0,
            "max": 60000,
            "minInterval": 0,
            "splitLine": {
                "show": true,
                "lineStyle": {
                    "show": true,
                    "width": 1,
                    "opacity": 1,
                    "curveness": 0,
                    "type": "solid"
                }
            }
        },
        {
            "type": "value",
            "name": "\u6b21\u6570",
            "show": true,
            "scale": false,
            "nameLocation": "end",
            "nameGap": 15,
            "interval": 500,
            "gridIndex": 0,
            "inverse": false,
            "offset": 0,
            "splitNumber": 5,
            "min": 0,
            "max": 3000,
            "minInterval": 0,
            "splitLine": {
                "show": false,
                "lineStyle": {
                    "show": true,
                    "width": 1,
                    "opacity": 1,
                    "curveness": 0,
                    "type": "solid"
                }
            }
        }
    ],
    "title": [
        {
            "text": "\u53cc\u5341\u4e8c\u524d\u540e\u7528\u6237\u5404\u884c\u4e3a\u60c5\u51b5",
            "left": "left",
            "padding": 5,
            "itemGap": 10
        }
    ]
};
                chart_fb3083257c284095a7caaa0578773c01.setOption(option_fb3083257c284095a7caaa0578773c01);
        });
    </script>




双十二活动主要有两个高峰时间段，12月11日18时-12月12日1时和12月12日的18时-24时，在双十二之前会出现用户的点击、收藏和加购行为的大幅增加，特别是加入购物车的行为，说明用户在双十二前依旧在大量筛选商品，对于有购买意向的商品用户会优先选择加入购物车。


```python
data_12 = data_user[(data_user['date'] =='2014-12-12') ]
behavior_count_12 = data_12.groupby(['behavior_type','user_id','item_id'])['item_category'].count().reset_index().rename(columns={'item_category':'total'})
pv_count_12 = behavior_count_12[behavior_count_12['behavior_type'] == 1]
fav_count_12 = behavior_count_12[behavior_count_12['behavior_type'] == 2]
cart_count_12 = behavior_count_12[behavior_count_12['behavior_type'] == 3]
buy_count_12 = behavior_count_12[behavior_count_12['behavior_type'] == 4]

all_data_12 = pd.merge(pv_count_12,fav_count_12,how='left',on=['user_id','item_id']).rename(columns={'behavior_type_x':'pv','behavior_type_y':'fav','total_x':'total_pv','total_y':'total_fav'})
all_data_12 = pd.merge(all_data_12,cart_count_12,how='left',on=['user_id','item_id'])
all_data_12 = pd.merge(all_data_12,buy_count_12,how='left',on=['user_id','item_id']).rename(columns={'behavior_type_x':'cart','behavior_type_y':'buy','total_x':'total_cart','total_y':'total_buy'})
all_data_12 = all_data_12.fillna(0)
```


```python
#用户点击—购买路径表
pv_buy_12 = all_data_12.loc[(all_data_12['fav']==0)&(all_data_12['cart']==0)]
#用户点击—收藏—购买路径表
pv_fav_buy_12 = all_data_12.loc[(all_data_12['fav']==2)&(all_data_12['cart']==0)]
#用户点击—加购—购买路径表
pv_cart_buy_12 = all_data_12.loc[(all_data_12['fav']==0)&(all_data_12['cart']==3)]
#用户点击—收藏和加购—购买路径表
pv_fav_cart_buy_12 = all_data_12.loc[(all_data_12['fav']==2)&(all_data_12['cart']==3)]
```


```python
#用户点击—购买转换漏斗
attr_1 = ['点击','购买']
values_1 = [np.around(pv_buy_12['total_pv'].sum()/pv_buy_12['total_pv'].sum()*100,2)
        ,np.around(pv_buy_12['total_buy'].sum()/pv_buy_12['total_pv'].sum()*100,2)]
pv_buy_rate_12 = (
    Funnel()
    .add("商品", [list(z) for z in zip(attr_1, values_1)],
    )
    .set_global_opts(title_opts=opts.TitleOpts(title="点击—购买转化漏斗"),
    legend_opts=opts.LegendOpts(is_show=True,pos_bottom='90%'))
    .set_series_opts(label_opts=opts.LabelOpts(formatter="{b}: {c}%"))
)


#用户点击—收藏—购买转换漏斗
attr_2 = ['点击','收藏','购买']
values_2 = [np.around(pv_fav_buy_12['total_pv'].sum()/pv_fav_buy_12['total_pv'].sum()*100,2)
        ,np.around(pv_fav_buy_12['total_fav'].sum()/pv_fav_buy_12['total_pv'].sum()*100,2)
        ,np.around(pv_fav_buy_12['total_buy'].sum()/pv_fav_buy_12['total_pv'].sum()*100,2)]
pv_fav_buy_rate_12 = (
    Funnel()
    .add("商品", [list(z) for z in zip(attr_2, values_2)],
    )
    .set_global_opts(title_opts=opts.TitleOpts(title="点击—收藏—购买转化漏斗"),
    legend_opts=opts.LegendOpts(is_show=True,pos_bottom='90%'))
    .set_series_opts(label_opts=opts.LabelOpts(formatter="{b}: {c}%"))
)


#用户点击—加购—购买转换漏斗
attr_3 = ['点击','加入购物车','购买']
values_3 = [np.around(pv_cart_buy_12['total_pv'].sum()/pv_cart_buy_12['total_pv'].sum()*100,2)
        ,np.around(pv_cart_buy_12['total_cart'].sum()/pv_cart_buy_12['total_pv'].sum()*100,2)
        ,np.around(pv_cart_buy_12['total_buy'].sum()/pv_cart_buy_12['total_pv'].sum()*100,2)]
pv_cart_buy_rate_12 = (
    Funnel()
    .add("商品", [list(z) for z in zip(attr_3, values_3)],
    )
    .set_global_opts(title_opts=opts.TitleOpts(title="点击—加入购物车—购买转化漏斗"),
    legend_opts=opts.LegendOpts(is_show=True,pos_bottom='90%'))
    .set_series_opts(label_opts=opts.LabelOpts(formatter="{b}: {c}%"))
)


#用户点击—收藏和加购—购买转换漏斗
attr_4 = ['点击','收藏和加入购物车','购买']
values_4 = [np.around(pv_fav_cart_buy_12['total_pv'].sum()/pv_fav_cart_buy_12['total_pv'].sum()*100,2)
        ,np.around((pv_fav_cart_buy_12['total_cart'].sum()+pv_fav_cart_buy_12['total_fav'].sum())/pv_fav_cart_buy_12['total_pv'].sum()*100,2)
        ,np.around(pv_fav_cart_buy_12['total_buy'].sum()/pv_fav_cart_buy_12['total_pv'].sum()*100,2)]
pv_fav_cart_buy_rate_12 = (
    Funnel()
    .add("商品", [list(z) for z in zip(attr_4, values_4)],
    )
    .set_global_opts(title_opts=opts.TitleOpts(title="点击—收藏和加入购物车—购买转化漏斗"),
    legend_opts=opts.LegendOpts(is_show=True,pos_bottom='90%'))
    .set_series_opts(label_opts=opts.LabelOpts(formatter="{b}: {c}%"))
)


#可视化各行为路径漏斗图
tab = Tab()
tab.add(pv_buy_rate_12, "点击—购买转化漏斗")
tab.add(pv_fav_buy_rate_12, "点击—收藏—购买转化漏斗")
tab.add(pv_cart_buy_rate_12, "点击—加入购物车—购买转化漏斗")
tab.add(pv_fav_cart_buy_rate_12, "点击—收藏和加入购物车—购买转化漏斗")
tab.render_notebook()
```





<script>
    require.config({
        paths: {
            'echarts':'https://assets.pyecharts.org/assets/echarts.min'
        }
    });
</script>

    <style>
        .tab {
            overflow: hidden;
            border: 1px solid #ccc;
            background-color: #f1f1f1;
        }

        .tab button {
            background-color: inherit;
            float: left;
            border: none;
            outline: none;
            cursor: pointer;
            padding: 12px 16px;
            transition: 0.3s;
        }

        .tab button:hover {
            background-color: #ddd;
        }

        .tab button.active {
            background-color: #ccc;
        }

        .chart-container {
            display: none;
            padding: 6px 12px;
            border-top: none;
        }
    </style>
<div class="tab">
            <button class="tablinks" onclick="showChart(event, 'b52a1bae8ecb4c63ab3d388390bf0d39')">点击—购买转化漏斗</button>
            <button class="tablinks" onclick="showChart(event, 'b51dcf3a434c4f2b85f964ba2dbc3f4e')">点击—收藏—购买转化漏斗</button>
            <button class="tablinks" onclick="showChart(event, 'ba1f60ff9aa44507a74921656e5072e9')">点击—加入购物车—购买转化漏斗</button>
            <button class="tablinks" onclick="showChart(event, '9c6e6afba9af4473abef20a51c02507c')">点击—收藏和加入购物车—购买转化漏斗</button>
    </div>

        <div id="b52a1bae8ecb4c63ab3d388390bf0d39" class="chart-container" style="width:900px; height:500px;"></div>
        <div id="b51dcf3a434c4f2b85f964ba2dbc3f4e" class="chart-container" style="width:900px; height:500px;"></div>
        <div id="ba1f60ff9aa44507a74921656e5072e9" class="chart-container" style="width:900px; height:500px;"></div>
        <div id="9c6e6afba9af4473abef20a51c02507c" class="chart-container" style="width:900px; height:500px;"></div>

<script>
        require(['echarts'], function(echarts) {
                var chart_b52a1bae8ecb4c63ab3d388390bf0d39 = echarts.init(
                    document.getElementById('b52a1bae8ecb4c63ab3d388390bf0d39'), 'white', {renderer: 'canvas'});
                var option_b52a1bae8ecb4c63ab3d388390bf0d39 = {
    "animation": true,
    "animationThreshold": 2000,
    "animationDuration": 1000,
    "animationEasing": "cubicOut",
    "animationDelay": 0,
    "animationDurationUpdate": 300,
    "animationEasingUpdate": "cubicOut",
    "animationDelayUpdate": 0,
    "color": [
        "#c23531",
        "#2f4554",
        "#61a0a8",
        "#d48265",
        "#749f83",
        "#ca8622",
        "#bda29a",
        "#6e7074",
        "#546570",
        "#c4ccd3",
        "#f05b72",
        "#ef5b9c",
        "#f47920",
        "#905a3d",
        "#fab27b",
        "#2a5caa",
        "#444693",
        "#726930",
        "#b2d235",
        "#6d8346",
        "#ac6767",
        "#1d953f",
        "#6950a1",
        "#918597"
    ],
    "series": [
        {
            "type": "funnel",
            "name": "\u5546\u54c1",
            "data": [
                {
                    "name": "\u70b9\u51fb",
                    "value": 100.0
                },
                {
                    "name": "\u8d2d\u4e70",
                    "value": 0.89
                }
            ],
            "sort": "descending",
            "gap": 0,
            "label": {
                "show": true,
                "position": "top",
                "margin": 8,
                "formatter": "{b}: {c}%"
            },
            "rippleEffect": {
                "show": true,
                "brushType": "stroke",
                "scale": 2.5,
                "period": 4
            }
        }
    ],
    "legend": [
        {
            "data": [
                "\u70b9\u51fb",
                "\u8d2d\u4e70"
            ],
            "selected": {
                "\u70b9\u51fb": true,
                "\u8d2d\u4e70": true
            },
            "show": true,
            "bottom": "90%",
            "padding": 5,
            "itemGap": 10,
            "itemWidth": 25,
            "itemHeight": 14
        }
    ],
    "tooltip": {
        "show": true,
        "trigger": "item",
        "triggerOn": "mousemove|click",
        "axisPointer": {
            "type": "line"
        },
        "showContent": true,
        "alwaysShowContent": false,
        "showDelay": 0,
        "hideDelay": 100,
        "textStyle": {
            "fontSize": 14
        },
        "borderWidth": 0,
        "padding": 5
    },
    "title": [
        {
            "text": "\u70b9\u51fb\u2014\u8d2d\u4e70\u8f6c\u5316\u6f0f\u6597",
            "padding": 5,
            "itemGap": 10
        }
    ]
};
                chart_b52a1bae8ecb4c63ab3d388390bf0d39.setOption(option_b52a1bae8ecb4c63ab3d388390bf0d39);
                var chart_b51dcf3a434c4f2b85f964ba2dbc3f4e = echarts.init(
                    document.getElementById('b51dcf3a434c4f2b85f964ba2dbc3f4e'), 'white', {renderer: 'canvas'});
                var option_b51dcf3a434c4f2b85f964ba2dbc3f4e = {
    "animation": true,
    "animationThreshold": 2000,
    "animationDuration": 1000,
    "animationEasing": "cubicOut",
    "animationDelay": 0,
    "animationDurationUpdate": 300,
    "animationEasingUpdate": "cubicOut",
    "animationDelayUpdate": 0,
    "color": [
        "#c23531",
        "#2f4554",
        "#61a0a8",
        "#d48265",
        "#749f83",
        "#ca8622",
        "#bda29a",
        "#6e7074",
        "#546570",
        "#c4ccd3",
        "#f05b72",
        "#ef5b9c",
        "#f47920",
        "#905a3d",
        "#fab27b",
        "#2a5caa",
        "#444693",
        "#726930",
        "#b2d235",
        "#6d8346",
        "#ac6767",
        "#1d953f",
        "#6950a1",
        "#918597"
    ],
    "series": [
        {
            "type": "funnel",
            "name": "\u5546\u54c1",
            "data": [
                {
                    "name": "\u70b9\u51fb",
                    "value": 100.0
                },
                {
                    "name": "\u6536\u85cf",
                    "value": 32.44
                },
                {
                    "name": "\u8d2d\u4e70",
                    "value": 1.17
                }
            ],
            "sort": "descending",
            "gap": 0,
            "label": {
                "show": true,
                "position": "top",
                "margin": 8,
                "formatter": "{b}: {c}%"
            },
            "rippleEffect": {
                "show": true,
                "brushType": "stroke",
                "scale": 2.5,
                "period": 4
            }
        }
    ],
    "legend": [
        {
            "data": [
                "\u70b9\u51fb",
                "\u8d2d\u4e70",
                "\u6536\u85cf"
            ],
            "selected": {
                "\u70b9\u51fb": true,
                "\u6536\u85cf": true,
                "\u8d2d\u4e70": true
            },
            "show": true,
            "bottom": "90%",
            "padding": 5,
            "itemGap": 10,
            "itemWidth": 25,
            "itemHeight": 14
        }
    ],
    "tooltip": {
        "show": true,
        "trigger": "item",
        "triggerOn": "mousemove|click",
        "axisPointer": {
            "type": "line"
        },
        "showContent": true,
        "alwaysShowContent": false,
        "showDelay": 0,
        "hideDelay": 100,
        "textStyle": {
            "fontSize": 14
        },
        "borderWidth": 0,
        "padding": 5
    },
    "title": [
        {
            "text": "\u70b9\u51fb\u2014\u6536\u85cf\u2014\u8d2d\u4e70\u8f6c\u5316\u6f0f\u6597",
            "padding": 5,
            "itemGap": 10
        }
    ]
};
                chart_b51dcf3a434c4f2b85f964ba2dbc3f4e.setOption(option_b51dcf3a434c4f2b85f964ba2dbc3f4e);
                var chart_ba1f60ff9aa44507a74921656e5072e9 = echarts.init(
                    document.getElementById('ba1f60ff9aa44507a74921656e5072e9'), 'white', {renderer: 'canvas'});
                var option_ba1f60ff9aa44507a74921656e5072e9 = {
    "animation": true,
    "animationThreshold": 2000,
    "animationDuration": 1000,
    "animationEasing": "cubicOut",
    "animationDelay": 0,
    "animationDurationUpdate": 300,
    "animationEasingUpdate": "cubicOut",
    "animationDelayUpdate": 0,
    "color": [
        "#c23531",
        "#2f4554",
        "#61a0a8",
        "#d48265",
        "#749f83",
        "#ca8622",
        "#bda29a",
        "#6e7074",
        "#546570",
        "#c4ccd3",
        "#f05b72",
        "#ef5b9c",
        "#f47920",
        "#905a3d",
        "#fab27b",
        "#2a5caa",
        "#444693",
        "#726930",
        "#b2d235",
        "#6d8346",
        "#ac6767",
        "#1d953f",
        "#6950a1",
        "#918597"
    ],
    "series": [
        {
            "type": "funnel",
            "name": "\u5546\u54c1",
            "data": [
                {
                    "name": "\u70b9\u51fb",
                    "value": 100.0
                },
                {
                    "name": "\u52a0\u5165\u8d2d\u7269\u8f66",
                    "value": 25.96
                },
                {
                    "name": "\u8d2d\u4e70",
                    "value": 9.49
                }
            ],
            "sort": "descending",
            "gap": 0,
            "label": {
                "show": true,
                "position": "top",
                "margin": 8,
                "formatter": "{b}: {c}%"
            },
            "rippleEffect": {
                "show": true,
                "brushType": "stroke",
                "scale": 2.5,
                "period": 4
            }
        }
    ],
    "legend": [
        {
            "data": [
                "\u70b9\u51fb",
                "\u52a0\u5165\u8d2d\u7269\u8f66",
                "\u8d2d\u4e70"
            ],
            "selected": {
                "\u70b9\u51fb": true,
                "\u52a0\u5165\u8d2d\u7269\u8f66": true,
                "\u8d2d\u4e70": true
            },
            "show": true,
            "bottom": "90%",
            "padding": 5,
            "itemGap": 10,
            "itemWidth": 25,
            "itemHeight": 14
        }
    ],
    "tooltip": {
        "show": true,
        "trigger": "item",
        "triggerOn": "mousemove|click",
        "axisPointer": {
            "type": "line"
        },
        "showContent": true,
        "alwaysShowContent": false,
        "showDelay": 0,
        "hideDelay": 100,
        "textStyle": {
            "fontSize": 14
        },
        "borderWidth": 0,
        "padding": 5
    },
    "title": [
        {
            "text": "\u70b9\u51fb\u2014\u52a0\u5165\u8d2d\u7269\u8f66\u2014\u8d2d\u4e70\u8f6c\u5316\u6f0f\u6597",
            "padding": 5,
            "itemGap": 10
        }
    ]
};
                chart_ba1f60ff9aa44507a74921656e5072e9.setOption(option_ba1f60ff9aa44507a74921656e5072e9);
                var chart_9c6e6afba9af4473abef20a51c02507c = echarts.init(
                    document.getElementById('9c6e6afba9af4473abef20a51c02507c'), 'white', {renderer: 'canvas'});
                var option_9c6e6afba9af4473abef20a51c02507c = {
    "animation": true,
    "animationThreshold": 2000,
    "animationDuration": 1000,
    "animationEasing": "cubicOut",
    "animationDelay": 0,
    "animationDurationUpdate": 300,
    "animationEasingUpdate": "cubicOut",
    "animationDelayUpdate": 0,
    "color": [
        "#c23531",
        "#2f4554",
        "#61a0a8",
        "#d48265",
        "#749f83",
        "#ca8622",
        "#bda29a",
        "#6e7074",
        "#546570",
        "#c4ccd3",
        "#f05b72",
        "#ef5b9c",
        "#f47920",
        "#905a3d",
        "#fab27b",
        "#2a5caa",
        "#444693",
        "#726930",
        "#b2d235",
        "#6d8346",
        "#ac6767",
        "#1d953f",
        "#6950a1",
        "#918597"
    ],
    "series": [
        {
            "type": "funnel",
            "name": "\u5546\u54c1",
            "data": [
                {
                    "name": "\u70b9\u51fb",
                    "value": 100.0
                },
                {
                    "name": "\u6536\u85cf\u548c\u52a0\u5165\u8d2d\u7269\u8f66",
                    "value": 38.22
                },
                {
                    "name": "\u8d2d\u4e70",
                    "value": 8.42
                }
            ],
            "sort": "descending",
            "gap": 0,
            "label": {
                "show": true,
                "position": "top",
                "margin": 8,
                "formatter": "{b}: {c}%"
            },
            "rippleEffect": {
                "show": true,
                "brushType": "stroke",
                "scale": 2.5,
                "period": 4
            }
        }
    ],
    "legend": [
        {
            "data": [
                "\u70b9\u51fb",
                "\u6536\u85cf\u548c\u52a0\u5165\u8d2d\u7269\u8f66",
                "\u8d2d\u4e70"
            ],
            "selected": {
                "\u70b9\u51fb": true,
                "\u6536\u85cf\u548c\u52a0\u5165\u8d2d\u7269\u8f66": true,
                "\u8d2d\u4e70": true
            },
            "show": true,
            "bottom": "90%",
            "padding": 5,
            "itemGap": 10,
            "itemWidth": 25,
            "itemHeight": 14
        }
    ],
    "tooltip": {
        "show": true,
        "trigger": "item",
        "triggerOn": "mousemove|click",
        "axisPointer": {
            "type": "line"
        },
        "showContent": true,
        "alwaysShowContent": false,
        "showDelay": 0,
        "hideDelay": 100,
        "textStyle": {
            "fontSize": 14
        },
        "borderWidth": 0,
        "padding": 5
    },
    "title": [
        {
            "text": "\u70b9\u51fb\u2014\u6536\u85cf\u548c\u52a0\u5165\u8d2d\u7269\u8f66\u2014\u8d2d\u4e70\u8f6c\u5316\u6f0f\u6597",
            "padding": 5,
            "itemGap": 10
        }
    ]
};
                chart_9c6e6afba9af4473abef20a51c02507c.setOption(option_9c6e6afba9af4473abef20a51c02507c);
        });
    </script>
<script>
        (function() {
            containers = document.getElementsByClassName("chart-container");
            if(containers.length > 0) {
                containers[0].style.display = "block";
            }
        })()

        function showChart(evt, chartID) {
            let containers = document.getElementsByClassName("chart-container");
            for (let i = 0; i < containers.length; i++) {
                containers[i].style.display = "none";
            }

            let tablinks = document.getElementsByClassName("tablinks");
            for (let i = 0; i < tablinks.length; i++) {
                tablinks[i].className = "tablinks";
            }

            document.getElementById(chartID).style.display = "block";
            evt.currentTarget.className += " active";
        }
    </script>




# 结论与建议

双十二活动的效果立竿见影，各项指标均得到一定幅度的提升，但是此类大型活动不宜频繁，因此需要通过其他途径来提高平台收入，这需要从提高用户点击、提高用户点击转化率、提高用户平均订单数等方面入手。

在提高用户点击量方面，可以着重在用户的浏览的高峰时间段进行促销活动，以及一些相关的营销推广。

在提高用户点击转化率方面，可以针对用户进行收藏和加入购物车的商品，提供如发放优惠券，满减活动，分期免息等优惠的方式，刺激用户购买。

在提高用户平均订单数方面，可以针对10天内购买过的用户可以提高对平台商品的推送频率，进一步刺激用户的购买欲。



```python

```
